<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>插曲一(ros1)</title>
      <link href="/2025/04/08/13/"/>
      <url>/2025/04/08/13/</url>
      
        <content type="html"><![CDATA[<h1 id="cpp节点编写-ros1"><a href="#cpp节点编写-ros1" class="headerlink" title="cpp节点编写(ros1)"></a>cpp节点编写(ros1)</h1><blockquote><h3 id="ROS1中，cpp对应的接口叫—roscpp"><a href="#ROS1中，cpp对应的接口叫—roscpp" class="headerlink" title="ROS1中，cpp对应的接口叫—roscpp"></a>ROS1中，cpp对应的接口叫—roscpp</h3><h3 id="与ROS2一样，创建一个功能包之后，在该包的src-source-文件下新建cpp文件，先在工作空间下的-src-下创建一个功能包"><a href="#与ROS2一样，创建一个功能包之后，在该包的src-source-文件下新建cpp文件，先在工作空间下的-src-下创建一个功能包" class="headerlink" title="与ROS2一样，创建一个功能包之后，在该包的src(source)文件下新建cpp文件，先在工作空间下的 src&#x2F; 下创建一个功能包"></a>与ROS2一样，创建一个功能包之后，在该包的src(source)文件下新建cpp文件，先在工作空间下的 src&#x2F; 下创建一个功能包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">roscd ros_workspace/src/</span><br><span class="line">catkin_create_pkg test_pkg roscpp rospy std_msgs</span><br></pre></td></tr></table></figure><h3 id="进入-test-pkg-src-，创建一个cpp文件，"><a href="#进入-test-pkg-src-，创建一个cpp文件，" class="headerlink" title="进入 test_pkg&#x2F;src&#x2F; ，创建一个cpp文件，"></a>进入 test_pkg&#x2F;src&#x2F; ，创建一个cpp文件，</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd test_pkg/src</span><br><span class="line">touch test.cpp</span><br></pre></td></tr></table></figure><h3 id="然后开始编写第一个cpp节点"><a href="#然后开始编写第一个cpp节点" class="headerlink" title="然后开始编写第一个cpp节点"></a>然后开始编写第一个cpp节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span>        <span class="comment">// 包含ROS的核心头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/String.h&quot;</span> <span class="comment">// 包含标准消息类型String的头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span>           <span class="comment">// 包含字符串流处理的头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 初始化ROS节点，命名为&quot;talker&quot;</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;talker&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个NodeHandle对象，用于与ROS系统通信</span></span><br><span class="line">    ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个发布者对象，发布名为&quot;chatter&quot;的消息队列长度为1000</span></span><br><span class="line">    ros::Publisher chatter_pub = n.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">&quot;chatter&quot;</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置循环频率为10Hz</span></span><br><span class="line">    <span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计数器变量，用于在发布的消息中增加计数值</span></span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 进入主循环，只要ROS系统正常运行就会一直执行</span></span><br><span class="line">    <span class="keyword">while</span>(ros::<span class="built_in">ok</span>())&#123;</span><br><span class="line">        <span class="comment">// 创建一个String类型的消息对象</span></span><br><span class="line">        std_msgs::String msg;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用字符串流创建消息内容，包含&quot;hello world&quot;和当前计数值</span></span><br><span class="line">        std::stringstream ss;</span><br><span class="line">        ss &lt;&lt; <span class="string">&quot;hello world &quot;</span> &lt;&lt; count;</span><br><span class="line">        msg.data = ss.<span class="built_in">str</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 在控制台打印出即将发布的消息内容</span></span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">&quot;%s&quot;</span>, msg.data.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发布消息到&quot;chatter&quot;主题</span></span><br><span class="line">        chatter_pub.<span class="built_in">publish</span>(msg);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理回调函数，确保其他节点可以及时收到消息</span></span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 按照设定的频率休眠一段时间</span></span><br><span class="line">        loop_rate.<span class="built_in">sleep</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 增加计数器值</span></span><br><span class="line">        ++count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主程序返回0，表示成功结束</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="与-ros2-的cpp节点大致是一样的，都有节点的初始化，只是使用的方法不同了"><a href="#与-ros2-的cpp节点大致是一样的，都有节点的初始化，只是使用的方法不同了" class="headerlink" title="与 ros2 的cpp节点大致是一样的，都有节点的初始化，只是使用的方法不同了"></a>与 ros2 的cpp节点大致是一样的，都有节点的初始化，只是使用的方法不同了</h3><h3 id="创建并编写好结点之后，修改CMakeList文件"><a href="#创建并编写好结点之后，修改CMakeList文件" class="headerlink" title="创建并编写好结点之后，修改CMakeList文件"></a>创建并编写好结点之后，修改CMakeList文件</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 指定src/下需要编译为可执行文件的源文件，前面节点名可以直接自己指定</span><br><span class="line">add_executable($&#123;PROJECT_NAME&#125;_node  src/test.cpp)</span><br><span class="line"></span><br><span class="line"># 指定所要使用的链接库</span><br><span class="line">target_link_libraries($&#123;PROJECT_NAME&#125;_node</span><br><span class="line">$&#123;catkin_LIBRARIES&#125;</span><br><span class="line">）</span><br></pre></td></tr></table></figure><h3 id="修改完CMakeList文件之后，就开始编译"><a href="#修改完CMakeList文件之后，就开始编译" class="headerlink" title="修改完CMakeList文件之后，就开始编译"></a>修改完CMakeList文件之后，就开始编译</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">roscd ros_workspace/</span><br><span class="line">catkin_make</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><h3 id="执行，先打开一个命令框执行-roscore"><a href="#执行，先打开一个命令框执行-roscore" class="headerlink" title="执行，先打开一个命令框执行 roscore"></a>执行，先打开一个命令框执行 roscore</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roscore</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros1/1.png"></p><h3 id="再打开一个窗口运行节点"><a href="#再打开一个窗口运行节点" class="headerlink" title="再打开一个窗口运行节点"></a>再打开一个窗口运行节点</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun test_pkg test_pkg_node</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros1/2.png"></p><h3 id="头文件的引用，在-ros1-下，cpp的-h-头文件要放在功能包目录下的include-pkg-name-路径下，"><a href="#头文件的引用，在-ros1-下，cpp的-h-头文件要放在功能包目录下的include-pkg-name-路径下，" class="headerlink" title="头文件的引用，在 ros1 下，cpp的 .h 头文件要放在功能包目录下的include&#x2F;pkg_name&#x2F; 路径下，"></a>头文件的引用，在 ros1 下，cpp的 .h 头文件要放在功能包目录下的include&#x2F;pkg_name&#x2F; 路径下，</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros1/3.png"></p><h3 id="创建好了头文件之后，需要引用头文件的cpp文件需要导入该头文件"><a href="#创建好了头文件之后，需要引用头文件的cpp文件需要导入该头文件" class="headerlink" title="创建好了头文件之后，需要引用头文件的cpp文件需要导入该头文件"></a>创建好了头文件之后，需要引用头文件的cpp文件需要导入该头文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;pkg_name/xxx.h&quot;</span></span></span><br></pre></td></tr></table></figure><h3 id="编译功能包时，cpp文件中引用的头文件，ros会在该功能包的-include-文件下开始找，给出以上路径后就可以精确找到被引用的头文件"><a href="#编译功能包时，cpp文件中引用的头文件，ros会在该功能包的-include-文件下开始找，给出以上路径后就可以精确找到被引用的头文件" class="headerlink" title="编译功能包时，cpp文件中引用的头文件，ros会在该功能包的 include&#x2F; 文件下开始找，给出以上路径后就可以精确找到被引用的头文件"></a>编译功能包时，cpp文件中引用的头文件，ros会在该功能包的 include&#x2F; 文件下开始找，给出以上路径后就可以精确找到被引用的头文件</h3><h3 id="如果要引用同一工作空间其他包的头文件，那么在创建功能包时，需要依赖要引用头文件所在的包"><a href="#如果要引用同一工作空间其他包的头文件，那么在创建功能包时，需要依赖要引用头文件所在的包" class="headerlink" title="如果要引用同一工作空间其他包的头文件，那么在创建功能包时，需要依赖要引用头文件所在的包"></a>如果要引用同一工作空间其他包的头文件，那么在创建功能包时，需要依赖要引用头文件所在的包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catkin_create_pkg my_pkg roscpp rospy std_msgs test_pkg</span><br></pre></td></tr></table></figure><h3 id="包创建好之后，他的CMakeList修改没有区别跟其他的包，被引用头文件的包的CMakeList文件需要修改"><a href="#包创建好之后，他的CMakeList修改没有区别跟其他的包，被引用头文件的包的CMakeList文件需要修改" class="headerlink" title="包创建好之后，他的CMakeList修改没有区别跟其他的包，被引用头文件的包的CMakeList文件需要修改"></a>包创建好之后，他的CMakeList修改没有区别跟其他的包，被引用头文件的包的CMakeList文件需要修改</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">catkin_package(</span><br><span class="line">  INCLUDE_DIRS include</span><br><span class="line">#  LIBRARIES test_pkg</span><br><span class="line">#  CATKIN_DEPENDS roscpp rospy std_msgs</span><br><span class="line">#  DEPENDS system_lib</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="这样修改之后，引用该包的头文件的包就能找到根据对应的路径找到需要引用的头文件了"><a href="#这样修改之后，引用该包的头文件的包就能找到根据对应的路径找到需要引用的头文件了" class="headerlink" title="这样修改之后，引用该包的头文件的包就能找到根据对应的路径找到需要引用的头文件了"></a>这样修改之后，引用该包的头文件的包就能找到根据对应的路径找到需要引用的头文件了</h3></blockquote><h3 id="launch文件的编写"><a href="#launch文件的编写" class="headerlink" title="launch文件的编写"></a>launch文件的编写</h3><blockquote><h3 id="因为，一个完整的ros程序，需要多个节点来完成所需实现的功能，而roslaunch一次性执行好多个节点的方法显然不够合理和高效，由此引出-launch文件。"><a href="#因为，一个完整的ros程序，需要多个节点来完成所需实现的功能，而roslaunch一次性执行好多个节点的方法显然不够合理和高效，由此引出-launch文件。" class="headerlink" title="因为，一个完整的ros程序，需要多个节点来完成所需实现的功能，而roslaunch一次性执行好多个节点的方法显然不够合理和高效，由此引出 launch文件。"></a>因为，一个完整的ros程序，需要多个节点来完成所需实现的功能，而roslaunch一次性执行好多个节点的方法显然不够合理和高效，由此引出 launch文件。</h3><h3 id="launch文件就是一个xml格式的脚本文件，把需要启动的节点都写进launch文件-中，这样就可以通过roslaunch工具来调用launch文件，执行这个脚本文件就一次性启动所有的节点程序。"><a href="#launch文件就是一个xml格式的脚本文件，把需要启动的节点都写进launch文件-中，这样就可以通过roslaunch工具来调用launch文件，执行这个脚本文件就一次性启动所有的节点程序。" class="headerlink" title="launch文件就是一个xml格式的脚本文件，把需要启动的节点都写进launch文件 中，这样就可以通过roslaunch工具来调用launch文件，执行这个脚本文件就一次性启动所有的节点程序。"></a>launch文件就是一个xml格式的脚本文件，把需要启动的节点都写进launch文件 中，这样就可以通过roslaunch工具来调用launch文件，执行这个脚本文件就一次性启动所有的节点程序。</h3><h3 id="创建一个包-robot-bringup，在其路径下创建一个文件-launch，在-launch-下创建并编辑-startup-launch-文件，用于同时启动多个节点"><a href="#创建一个包-robot-bringup，在其路径下创建一个文件-launch，在-launch-下创建并编辑-startup-launch-文件，用于同时启动多个节点" class="headerlink" title="创建一个包 robot_bringup，在其路径下创建一个文件 launch，在 launch&#x2F; 下创建并编辑 startup.launch 文件，用于同时启动多个节点"></a>创建一个包 robot_bringup，在其路径下创建一个文件 launch，在 launch&#x2F; 下创建并编辑 startup.launch 文件，用于同时启动多个节点</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">catkin_create_pkg robot_bringup</span><br><span class="line">cd robot_bringup</span><br><span class="line">mkdir launch</span><br><span class="line">cd launch/</span><br><span class="line">touch startup.launch</span><br><span class="line">subl startup.launch</span><br></pre></td></tr></table></figure><h3 id="编辑使之能同时运行-test-pkg-node-和-my-pkg-node-两个节点"><a href="#编辑使之能同时运行-test-pkg-node-和-my-pkg-node-两个节点" class="headerlink" title="编辑使之能同时运行 test_pkg_node 和 my_pkg_node 两个节点"></a>编辑使之能同时运行 test_pkg_node 和 my_pkg_node 两个节点</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># <span class="tag">&lt;<span class="name">launch</span>&gt;</span> 是根标签</span><br><span class="line"># <span class="tag">&lt;<span class="name">node</span>&gt;</span> 是节点标签,至少要有三个属性 pkg type name, type是指节点名,name给所运行的节点指定名称,他会覆盖ros::init的节点名, output 可以将单个节点的标准输出到终端</span><br><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;test_pkg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;test_pkg_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test_pkg_node&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;my_pkg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;my_pkg_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;my_pkg_node&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编译并运行"><a href="#编译并运行" class="headerlink" title="编译并运行"></a>编译并运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">catkin_make</span><br><span class="line">source ~/.bashrc</span><br><span class="line">roslaunch robot_bringup startup.launch</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros1/4.png"></p><h3 id="使用-include-标签，可以在当前-launch-文件中调用另外一个包的-launch文件"><a href="#使用-include-标签，可以在当前-launch-文件中调用另外一个包的-launch文件" class="headerlink" title="使用 include 标签，可以在当前 launch 文件中调用另外一个包的 launch文件"></a>使用 include 标签，可以在当前 launch 文件中调用另外一个包的 launch文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># find 命令可以直接搜索功能包的位置，代替直接使用绝对路径</span><br><span class="line"><span class="tag">&lt;<span class="name">include</span>  <span class="attr">file</span>=<span class="string">&quot;$(find package-name)/launch-file-name&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建新的功能包-third-pkg，在-src-中创建并编写-third-pkg-cpp"><a href="#创建新的功能包-third-pkg，在-src-中创建并编写-third-pkg-cpp" class="headerlink" title="创建新的功能包 third_pkg，在 src 中创建并编写 third_pkg.cpp"></a>创建新的功能包 third_pkg，在 src 中创建并编写 third_pkg.cpp</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">catkin_create_pkg third_pkg roscpp rospy std_msgs</span><br><span class="line">cd third_pkg/src</span><br><span class="line">touch third_pkg.cpp</span><br><span class="line">subl third_pkg.cpp</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> **argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;third_pkg&quot;</span>);</span><br><span class="line"></span><br><span class="line">ros::NodeHandle n;<span class="comment">// 更新话题的消息格式为自定义的消息格式</span></span><br><span class="line"></span><br><span class="line">ros::Publisher chatter_pub = n.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">&quot;third_pkg&quot;</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(ros::<span class="built_in">ok</span>())&#123;</span><br><span class="line"></span><br><span class="line">std_msgs::String msg;</span><br><span class="line"></span><br><span class="line">std::stringstream ss;</span><br><span class="line"></span><br><span class="line">ss&lt;&lt;<span class="string">&quot;third pkg:&quot;</span>&lt;&lt;count;</span><br><span class="line"></span><br><span class="line">msg.data = ss.<span class="built_in">str</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">&quot;%s&quot;</span>,msg.data.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">chatter_pub.<span class="built_in">publish</span>(msg);<span class="comment">//将消息发布到话题中</span></span><br><span class="line"></span><br><span class="line">ros::<span class="built_in">spinOnce</span>();</span><br><span class="line"></span><br><span class="line">loop_rate.<span class="built_in">sleep</span>();</span><br><span class="line"></span><br><span class="line">++count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修改CMakeList文件"><a href="#修改CMakeList文件" class="headerlink" title="修改CMakeList文件"></a>修改CMakeList文件</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add_executable(third_pkg_node src/third_pkg.cpp)</span><br><span class="line"></span><br><span class="line">target_link_libraries(third_pkg_node</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="在-third-pkg-下创建一个-launch-文件夹，并在该文件中创建并编译-third-pkg-launch-文件"><a href="#在-third-pkg-下创建一个-launch-文件夹，并在该文件中创建并编译-third-pkg-launch-文件" class="headerlink" title="在 third_pkg&#x2F; 下创建一个 launch 文件夹，并在该文件中创建并编译 third_pkg.launch 文件"></a>在 third_pkg&#x2F; 下创建一个 launch 文件夹，并在该文件中创建并编译 third_pkg.launch 文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir launch</span><br><span class="line">cd launch</span><br><span class="line">touch third_pkg.launch</span><br><span class="line">subl third_pkg.launch</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;third_pkg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;third_pkg_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;third_pkg_node&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="修改-robot-bringup-launch-下的-launch-文件"><a href="#修改-robot-bringup-launch-下的-launch-文件" class="headerlink" title="修改 robot_bringup&#x2F;launch&#x2F; 下的 launch 文件"></a>修改 robot_bringup&#x2F;launch&#x2F; 下的 launch 文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;test_pkg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;test_pkg_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test_pkg_node&quot;</span> <span class="attr">respawn</span>=<span class="string">&quot;true&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;my_pkg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;my_pkg_node&quot;</span> <span class="attr">name</span>=<span class="string">&quot;my_pkg_node&quot;</span> <span class="attr">required</span>=<span class="string">&quot;true&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">&quot;$(find third_pkg)/launch/third_pkg.launch&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="然后编译运行"><a href="#然后编译运行" class="headerlink" title="然后编译运行"></a>然后编译运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">catkin_make</span><br><span class="line">source ~/.bashrc</span><br><span class="line">roslaunch robot_bringup startup.launch</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros1/5.png"></p></blockquote><h3 id="好久没更新了，damn"><a href="#好久没更新了，damn" class="headerlink" title="好久没更新了，damn!"></a>好久没更新了，damn!</h3>]]></content>
      
      
      
        <tags>
            
            <tag> Learning </tag>
            
            <tag> ROS1 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第十弹</title>
      <link href="/2025/02/23/12/"/>
      <url>/2025/02/23/12/</url>
      
        <content type="html"><![CDATA[<h1 id="话题通信实践案例"><a href="#话题通信实践案例" class="headerlink" title="话题通信实践案例"></a>话题通信实践案例</h1><h2 id="自定义通信接口"><a href="#自定义通信接口" class="headerlink" title="自定义通信接口"></a>自定义通信接口</h2><blockquote><h3 id="在-chapter-3-下创建一个新的文件层，接着在-src-下创建功能包，并进入功能包，在其目录下创建文件-msg，再进入-msg-，创建文件SystemStatus-msg"><a href="#在-chapter-3-下创建一个新的文件层，接着在-src-下创建功能包，并进入功能包，在其目录下创建文件-msg，再进入-msg-，创建文件SystemStatus-msg" class="headerlink" title="在 chapter_3 下创建一个新的文件层，接着在 src&#x2F; 下创建功能包，并进入功能包，在其目录下创建文件 msg，再进入 msg&#x2F;，创建文件SystemStatus.msg"></a>在 chapter_3 下创建一个新的文件层，接着在 src&#x2F; 下创建功能包，并进入功能包，在其目录下创建文件 msg，再进入 msg&#x2F;，创建文件SystemStatus.msg</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/learn_ros2/chapter_3/</span><br><span class="line">mkdir -p topic_practice_ws/src</span><br><span class="line">cd src/</span><br><span class="line">ros2 pkg create status_interfaces --dependencies builtin_interfaces rosidl_default_generators --license Apache-2.0</span><br><span class="line">cd status_interfaces/</span><br><span class="line">mkdir msg</span><br><span class="line">cd msg</span><br><span class="line">touch SystemStatus.msg</span><br></pre></td></tr></table></figure><h3 id="编辑-msg-文件内容"><a href="#编辑-msg-文件内容" class="headerlink" title="编辑 .msg 文件内容"></a>编辑 .msg 文件内容</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">builtin_interfaces/Time stamp #记录时间戳</span><br><span class="line">string host_name # 主机名字</span><br><span class="line">float32 cpu_percent # cpu使用率</span><br><span class="line">float32 memory_percent # 内存使用率</span><br><span class="line">float32 memory_available # 内存总大小</span><br><span class="line">float64 net_sent # 网络发送数据总量</span><br><span class="line">float64 net_receive # 网络数据接收总量</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-和-package-xml-文件中添加相应语句"><a href="#在-CMakeLists-和-package-xml-文件中添加相应语句" class="headerlink" title="在 CMakeLists 和 package.xml 文件中添加相应语句"></a>在 CMakeLists 和 package.xml 文件中添加相应语句</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cmake函数，来自与rosidl_default_generators，将msg等消息接口定义文件转换成库或者头文件类</span></span><br><span class="line"><span class="comment"># 它会根据提供的消息接口去生成对应的cpp文件</span></span><br><span class="line">rosidl_generate_interfaces(<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line"><span class="string">&quot;msg/SystemStatus.msg&quot;</span></span><br><span class="line">DEPENDENCIES builtin_interfaces</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">license</span>&gt;</span>Apache-2.0<span class="tag">&lt;/<span class="name">license</span>&gt;</span></span><br><span class="line"># 添加这句</span><br><span class="line"><span class="tag">&lt;<span class="name">member_of_group</span>&gt;</span>rosidl_interface_packages<span class="tag">&lt;/<span class="name">member_of_group</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="然后编译并修改环境变量"><a href="#然后编译并修改环境变量" class="headerlink" title="然后编译并修改环境变量"></a>然后编译并修改环境变量</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/learn_ros2/chapter_3/topic_practice_ws/</span><br><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br></pre></td></tr></table></figure><h3 id="编译好之后，在-topic-practice-ws-installl-下，有一个与功能包同名的文件，在该文件下有一个-include-文件，该文件下也有一个与包名同名的文件，里面有个-msg文件，在该文件中，就是-msg-文件转换得来的-hpp-和-h-文件"><a href="#编译好之后，在-topic-practice-ws-installl-下，有一个与功能包同名的文件，在该文件下有一个-include-文件，该文件下也有一个与包名同名的文件，里面有个-msg文件，在该文件中，就是-msg-文件转换得来的-hpp-和-h-文件" class="headerlink" title="编译好之后，在 topic_practice_ws&#x2F;installl 下，有一个与功能包同名的文件，在该文件下有一个 include 文件，该文件下也有一个与包名同名的文件，里面有个 msg文件，在该文件中，就是 .msg 文件转换得来的 .hpp 和 .h 文件"></a>编译好之后，在 topic_practice_ws&#x2F;installl 下，有一个与功能包同名的文件，在该文件下有一个 include 文件，该文件下也有一个与包名同名的文件，里面有个 msg文件，在该文件中，就是 .msg 文件转换得来的 .hpp 和 .h 文件</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_29.png"></p><h3 id="另外，在-detail-文件中，system-status-struct-hpp-文件里有-msg文件中定义的属性"><a href="#另外，在-detail-文件中，system-status-struct-hpp-文件里有-msg文件中定义的属性" class="headerlink" title="另外，在 detail 文件中，system_status__struct.hpp 文件里有 .msg文件中定义的属性"></a>另外，在 detail 文件中，system_status__struct.hpp 文件里有 .msg文件中定义的属性</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_30.png"></p><h3 id="查看生成的头文件的定义"><a href="#查看生成的头文件的定义" class="headerlink" title="查看生成的头文件的定义"></a>查看生成的头文件的定义</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 interface show status_interfaces/msg/SystemStatus</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_31.png"></p></blockquote><h2 id="系统信息发布与获取"><a href="#系统信息发布与获取" class="headerlink" title="系统信息发布与获取"></a>系统信息发布与获取</h2><blockquote><h3 id="在-topic-practice-ws-src-下创建一个功能包-status-publisher，要依赖-status-interfaces，这里创建python的，因为要使用python的一个库-psutil，可以相对简单的得到系统当前的各种信息"><a href="#在-topic-practice-ws-src-下创建一个功能包-status-publisher，要依赖-status-interfaces，这里创建python的，因为要使用python的一个库-psutil，可以相对简单的得到系统当前的各种信息" class="headerlink" title="在 topic_practice_ws&#x2F;src&#x2F; 下创建一个功能包 status_publisher，要依赖 status_interfaces，这里创建python的，因为要使用python的一个库 psutil，可以相对简单的得到系统当前的各种信息"></a>在 topic_practice_ws&#x2F;src&#x2F; 下创建一个功能包 status_publisher，要依赖 status_interfaces，这里创建python的，因为要使用python的一个库 psutil，可以相对简单的得到系统当前的各种信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create status_publisher --build-type ament_python --dependencies rclpy status_interfaces --licence Apache-2.0</span><br></pre></td></tr></table></figure><h3 id="在-status-publisher-src-下创建文件-sys-status-pub-cpp，内容如下"><a href="#在-status-publisher-src-下创建文件-sys-status-pub-cpp，内容如下" class="headerlink" title="在 status_publisher&#x2F;src 下创建文件 sys_status_pub.cpp，内容如下"></a>在 status_publisher&#x2F;src 下创建文件 sys_status_pub.cpp，内容如下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rclpy  <span class="comment"># 导入ROS 2的Python客户端库</span></span><br><span class="line"><span class="keyword">from</span> status_interfaces.msg <span class="keyword">import</span> SystemStatus  <span class="comment"># 导入自定义消息类型 SystemStatus</span></span><br><span class="line"><span class="keyword">from</span> rclpy.node <span class="keyword">import</span> Node  <span class="comment"># 导入ROS2节点类</span></span><br><span class="line"><span class="keyword">import</span> psutil  <span class="comment"># 用于获取系统的硬件状态，如CPU、内存和网络等</span></span><br><span class="line"><span class="keyword">import</span> platform  <span class="comment"># 用于获取系统的基本信息，如主机名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个类 SysStatusPub，继承自 Node 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SysStatusPub</span>(<span class="title class_ inherited__">Node</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, node_name</span>):</span><br><span class="line">        <span class="comment"># 初始化节点，node_name是节点的名字</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(node_name)  </span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 创建一个发布器，用于发布类型为 SystemStatus 的消息到 &#x27;sys_status&#x27; 话题，队列大小为 10</span></span><br><span class="line">           <span class="variable language_">self</span>.status_publisher_ = <span class="variable language_">self</span>.create_publisher(SystemStatus, <span class="string">&#x27;sys_status&#x27;</span>, <span class="number">10</span>)</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 创建定时器，每隔1秒调用一次 timer_callback 方法</span></span><br><span class="line">           <span class="variable language_">self</span>.timer_ = <span class="variable language_">self</span>.create_timer(<span class="number">1.0</span>, <span class="variable language_">self</span>.timer_callback)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 定时器回调函数，每隔1秒被调用一次</span></span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">timer_callback</span>(<span class="params">self</span>):</span><br><span class="line">           <span class="comment"># 获取CPU的使用率，返回值为浮动百分比</span></span><br><span class="line">           cpu_percent = psutil.cpu_percent()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 获取内存的使用信息，包括已使用、总量、可用等数据</span></span><br><span class="line">           memory_info = psutil.virtual_memory()</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取网络I/O的发送和接收信息（字节数）</span></span><br><span class="line">           net_io_counters = psutil.net_io_counters()</span><br><span class="line">   </span><br><span class="line">           <span class="comment"># 创建一个SystemStatus消息对象</span></span><br><span class="line">           msg = SystemStatus()</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 设置时间戳，获取当前时间并转换为消息格式</span></span><br><span class="line">        msg.stamp = <span class="variable language_">self</span>.get_clock().now().to_msg()</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取主机名</span></span><br><span class="line">                msg.host_name = platform.node()</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取并设置CPU使用率</span></span><br><span class="line">           msg.cpu_percent = cpu_percent</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取并设置内存的使用百分比</span></span><br><span class="line">           msg.memory_percent = memory_info.percent</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取并设置内存的总大小，转换为float类型</span></span><br><span class="line">        msg.memory_total = <span class="built_in">float</span>(memory_info.total)</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 获取并设置内存的可用大小，转换为float类型</span></span><br><span class="line">           msg.memory_available = <span class="built_in">float</span>(memory_info.available)</span><br><span class="line">        </span><br><span class="line">           <span class="comment"># 获取并设置网络发送的字节数，单位转换为MB</span></span><br><span class="line">           msg.net_sent = net_io_counters.bytes_sent / <span class="number">1024</span> / <span class="number">1024</span></span><br><span class="line">           </span><br><span class="line">        <span class="comment"># 获取并设置网络接收的字节数，单位转换为MB</span></span><br><span class="line">           msg.net_recv = net_io_counters.bytes_recv / <span class="number">1024</span> / <span class="number">1024</span></span><br><span class="line">   </span><br><span class="line">           <span class="comment"># 记录日志，输出当前的SystemStatus消息</span></span><br><span class="line">           <span class="variable language_">self</span>.get_logger().info(<span class="string">f&#x27;发布: <span class="subst">&#123;<span class="built_in">str</span>(msg)&#125;</span>&#x27;</span>)</span><br><span class="line">           </span><br><span class="line">           <span class="comment"># 发布消息</span></span><br><span class="line">           <span class="variable language_">self</span>.status_publisher_.publish(msg)</span><br><span class="line">        </span><br><span class="line">   </span><br><span class="line">   <span class="comment"># main函数，程序入口</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">            <span class="comment"># 初始化rclpy客户端库</span></span><br><span class="line">       rclpy.init()</span><br><span class="line">   </span><br><span class="line">    <span class="comment"># 创建一个SysStatusPub节点对象，节点名称为 &#x27;sys_status_pub&#x27;</span></span><br><span class="line">       node = SysStatusPub(<span class="string">&#x27;sys_status_pub&#x27;</span>)</span><br><span class="line">       </span><br><span class="line">       <span class="comment"># 使节点进入循环，保持节点运行并监听定时器事件</span></span><br><span class="line">    rclpy.spin(node)</span><br><span class="line">   </span><br><span class="line">       <span class="comment"># 关闭节点并关闭rclpy</span></span><br><span class="line">       rclpy.shutdown()</span><br></pre></td></tr></table></figure><h3 id="在-setup-py-中添加相应语句"><a href="#在-setup-py-中添加相应语句" class="headerlink" title="在 setup.py 中添加相应语句"></a>在 setup.py 中添加相应语句</h3>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> find_packages, setup</span><br><span class="line"></span><br><span class="line">package_name = <span class="string">&#x27;status_publisher&#x27;</span></span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=package_name,</span><br><span class="line">    version=<span class="string">&#x27;0.0.0&#x27;</span>,</span><br><span class="line"> packages=find_packages(exclude=[<span class="string">&#x27;test&#x27;</span>]),</span><br><span class="line">    data_files=[</span><br><span class="line">        (<span class="string">&#x27;share/ament_index/resource_index/packages&#x27;</span>,</span><br><span class="line">            [<span class="string">&#x27;resource/&#x27;</span> + package_name]),</span><br><span class="line">     (<span class="string">&#x27;share/&#x27;</span> + package_name, [<span class="string">&#x27;package.xml&#x27;</span>]),</span><br><span class="line">    ],</span><br><span class="line">    install_requires=[<span class="string">&#x27;setuptools&#x27;</span>],</span><br><span class="line">    zip_safe=<span class="literal">True</span>,</span><br><span class="line">    maintainer=<span class="string">&#x27;yanzu&#x27;</span>,</span><br><span class="line">    maintainer_email=<span class="string">&#x27;yanzu@todo.todo&#x27;</span>,</span><br><span class="line">    description=<span class="string">&#x27;TODO: Package description&#x27;</span>,</span><br><span class="line">         license=<span class="string">&#x27;Apache-2.0&#x27;</span>,</span><br><span class="line">    tests_require=[<span class="string">&#x27;pytest&#x27;</span>],</span><br><span class="line">    entry_points=&#123;</span><br><span class="line">        <span class="string">&#x27;console_scripts&#x27;</span>: [</span><br><span class="line">            <span class="comment"># 添加这句</span></span><br><span class="line">        <span class="string">&#x27;sys_status_pub = status_publisher.sys_status_pub:main&#x27;</span>,</span><br><span class="line">        ],</span><br><span class="line"> &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="然后编译运行"><a href="#然后编译运行" class="headerlink" title="然后编译运行"></a>然后编译运行</h3>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run status_publisher sys_status_pub</span><br></pre></td></tr></table></figure><p>   <img src="http://picbed.yanzu.tech/img/learn_ros2/pic_32.png"></p><h3 id="打印接口信息"><a href="#打印接口信息" class="headerlink" title="打印接口信息"></a>打印接口信息</h3>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic echo /sys_status</span><br></pre></td></tr></table></figure><p>   <img src="http://picbed.yanzu.tech/img/learn_ros2/pic_33.png"></p></blockquote><h2 id="在功能包中使用QT"><a href="#在功能包中使用QT" class="headerlink" title="在功能包中使用QT"></a>在功能包中使用QT</h2><blockquote><h3 id="在-topic-practice-ws-src-下创建功能包-status-display，且要依赖-status-interfaces"><a href="#在-topic-practice-ws-src-下创建功能包-status-display，且要依赖-status-interfaces" class="headerlink" title="在 topic_practice_ws&#x2F;src&#x2F; 下创建功能包 status_display，且要依赖 status_interfaces"></a>在 topic_practice_ws&#x2F;src&#x2F; 下创建功能包 status_display，且要依赖 status_interfaces</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create status_display --dependencies rclcpp status_interfaces --license Apache-2.0</span><br></pre></td></tr></table></figure><h3 id="在-status-display-src-下创建文件-hello-qt-cpp，内容如下"><a href="#在-status-display-src-下创建文件-hello-qt-cpp，内容如下" class="headerlink" title="在 status_display&#x2F;src&#x2F; 下创建文件 hello_qt.cpp，内容如下"></a>在 status_display&#x2F;src&#x2F; 下创建文件 hello_qt.cpp，内容如下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function">QApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">QLabel* label = <span class="keyword">new</span> <span class="built_in">QLabel</span>();</span><br><span class="line">QString message = QString::<span class="built_in">fromStdString</span>(<span class="string">&quot;hello qt!&quot;</span>);</span><br><span class="line">label-&gt;<span class="built_in">setText</span>(message);</span><br><span class="line">label-&gt;<span class="built_in">show</span>();</span><br><span class="line">app.<span class="built_in">exec</span>();<span class="comment">// 执行应用,阻塞代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-中添加相应语句"><a href="#在-CMakeLists-中添加相应语句" class="headerlink" title="在 CMakeLists 中添加相应语句"></a>在 CMakeLists 中添加相应语句</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找 qt5 组件</span></span><br><span class="line">find_package(Qt5 REQUIRED COMPONENTS Widgets)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加可执行文件</span></span><br><span class="line">add_executable(hello_qt src/hello_qt.cpp)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加依赖库</span></span><br><span class="line">target_link_libraries(hello_qt Qt5::Widgets)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝节点到 install/lib</span></span><br><span class="line">install(TARGETS hello_qt</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="然后编译执行"><a href="#然后编译执行" class="headerlink" title="然后编译执行"></a>然后编译执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run status_display hello_qt</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_34.png"></p></blockquote><h2 id="订阅数据并使用Qt显示"><a href="#订阅数据并使用Qt显示" class="headerlink" title="订阅数据并使用Qt显示"></a>订阅数据并使用Qt显示</h2><blockquote><h3 id="在-status-display-src-下创建文件-sys-status-display-cpp，内容如下"><a href="#在-status-display-src-下创建文件-sys-status-display-cpp，内容如下" class="headerlink" title="在 status_display&#x2F;src&#x2F; 下创建文件 sys_status_display.cpp，内容如下"></a>在 status_display&#x2F;src&#x2F; 下创建文件 sys_status_display.cpp，内容如下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span>      <span class="comment">// 引入Qt应用程序库，用于创建GUI界面</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span>            <span class="comment">// 引入Qt标签控件，用于显示系统状态信息</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span>           <span class="comment">// 引入Qt字符串类，用于处理字符串</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;rclcpp/rclcpp.hpp&gt;</span> <span class="comment">// 引入ROS2 C++客户端库</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;status_interfaces/msg/system_status.hpp&quot;</span> <span class="comment">// 引入自定义消息类型 SystemStatus</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 SystemStatus 类型简写</span></span><br><span class="line"><span class="keyword">using</span> SystemStatus = status_interfaces::msg::SystemStatus;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 SysStatusDisplay 类，继承自 ROS2 的 Node 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SysStatusDisplay</span> : <span class="keyword">public</span> rclcpp::Node &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// 定义一个共享指针的订阅者，订阅 SystemStatus 类型的消息</span></span><br><span class="line">    rclcpp::Subscription&lt;SystemStatus&gt;::SharedPtr subscriber_;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义 QLabel 控件，用于显示系统状态信息</span></span><br><span class="line">    QLabel* label_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// SysStatusDisplay 构造函数，初始化节点名为 &quot;sys_status_display&quot;</span></span><br><span class="line">    <span class="built_in">SysStatusDisplay</span>() : <span class="built_in">Node</span>(<span class="string">&quot;sys_status_display&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// 初始化 QLabel 控件</span></span><br><span class="line">        label_ = <span class="keyword">new</span> <span class="built_in">QLabel</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 创建一个订阅者，订阅 &quot;sys_status&quot; 话题，消息队列大小为10</span></span><br><span class="line">        subscriber_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_subscription</span>&lt;SystemStatus&gt;(</span><br><span class="line">            <span class="string">&quot;sys_status&quot;</span>, <span class="number">10</span>, </span><br><span class="line">            [&amp;](<span class="type">const</span> SystemStatus::SharedPtr msg) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">                <span class="comment">// 每当接收到消息时，更新标签文本</span></span><br><span class="line">                label_-&gt;<span class="built_in">setText</span>(<span class="built_in">get_qstr_from_msg</span>(msg));</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化时，先显示一个默认的空状态</span></span><br><span class="line">        label_-&gt;<span class="built_in">setText</span>(<span class="built_in">get_qstr_from_msg</span>(std::<span class="built_in">make_shared</span>&lt;SystemStatus&gt;()));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 显示 QLabel 控件</span></span><br><span class="line">        label_-&gt;<span class="built_in">show</span>();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将接收到的 SystemStatus 消息转换为 QString 类型的文本</span></span><br><span class="line">    <span class="function">QString <span class="title">get_qstr_from_msg</span><span class="params">(<span class="type">const</span> SystemStatus::SharedPtr msg)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 使用字符串流构造格式化的字符串</span></span><br><span class="line">        std::stringstream show_str;</span><br><span class="line">        show_str &lt;&lt;</span><br><span class="line">        <span class="string">&quot;==========系统状态可视化工具==========\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;数 据 时 间：\t&quot;</span> &lt;&lt; msg-&gt;stamp.sec &lt;&lt; <span class="string">&quot;\ts\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;主 机 名 字：\t&quot;</span> &lt;&lt; msg-&gt;host_name &lt;&lt; <span class="string">&quot;\t\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;CPU使用率：\t&quot;</span> &lt;&lt; msg-&gt;cpu_percent &lt;&lt; <span class="string">&quot;\t%\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;内存使用率：\t&quot;</span> &lt;&lt; msg-&gt;memory_percent &lt;&lt; <span class="string">&quot;\t%\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;可 用 内 存：\t&quot;</span> &lt;&lt; msg-&gt;memory_available &lt;&lt; <span class="string">&quot;\tMB\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;网络发送数据量：\t&quot;</span> &lt;&lt; msg-&gt;net_sent &lt;&lt; <span class="string">&quot;\tMB\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;网络接收数据量：\t&quot;</span> &lt;&lt; msg-&gt;net_recv &lt;&lt; <span class="string">&quot;\tMB\n&quot;</span> &lt;&lt;</span><br><span class="line">        <span class="string">&quot;====================================&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将构造的字符串转换为 QString 类型返回</span></span><br><span class="line">        <span class="keyword">return</span> QString::<span class="built_in">fromStdString</span>(show_str.<span class="built_in">str</span>());</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main 函数，程序入口</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化 ROS2 客户端库</span></span><br><span class="line">    rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化 Qt 应用程序</span></span><br><span class="line">    <span class="function">QApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 SysStatusDisplay 对象（ROS2节点和GUI控件）</span></span><br><span class="line">    <span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;SysStatusDisplay&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建并启动一个新的线程，运行 ROS2 节点的 spin 方法</span></span><br><span class="line">    <span class="function">std::thread <span class="title">spin_thread</span><span class="params">([&amp;]()-&gt;<span class="type">void</span>&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="comment">// 运行 ROS2 事件循环，处理订阅和回调</span></span></span></span><br><span class="line"><span class="params"><span class="function">        rclcpp::spin(node);</span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;)</span></span>;</span><br><span class="line">    <span class="comment">// 分离线程，使其在后台继续执行</span></span><br><span class="line">    spin_thread.<span class="built_in">detach</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 启动 Qt 应用程序的事件循环，开始界面显示并处理用户交互</span></span><br><span class="line">    app.<span class="built_in">exec</span>(); <span class="comment">// 阻塞，直到应用程序结束</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// 程序正常退出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-中添加相应语句-1"><a href="#在-CMakeLists-中添加相应语句-1" class="headerlink" title="在 CMakeLists 中添加相应语句"></a>在 CMakeLists 中添加相应语句</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(sys_status_display src/sys_status_display.cpp)</span><br><span class="line"><span class="comment"># 添加依赖库</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(sys_status_display Qt5::Widgets)</span><br><span class="line">ament_target_dependencies(sys_status_display rclcpp status_interfaces)</span><br><span class="line"><span class="comment"># 拷贝节点到 install/lib</span></span><br><span class="line"><span class="keyword">install</span>(TARGETS hello_qt sys_status_display</span><br><span class="line">DESTINATION lib/<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="然后构建运行-提前运行-sys-status-pub-节点"><a href="#然后构建运行-提前运行-sys-status-pub-节点" class="headerlink" title="然后构建运行(提前运行 sys_status_pub 节点)"></a>然后构建运行(提前运行 sys_status_pub 节点)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run status_display sys_status_display</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_35.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第九弹</title>
      <link href="/2025/02/20/11/"/>
      <url>/2025/02/20/11/</url>
      
        <content type="html"><![CDATA[<h1 id="cpp话题订阅与发布"><a href="#cpp话题订阅与发布" class="headerlink" title="cpp话题订阅与发布"></a>cpp话题订阅与发布</h1><h2 id="发布速度控制小海龟画圆"><a href="#发布速度控制小海龟画圆" class="headerlink" title="发布速度控制小海龟画圆"></a>发布速度控制小海龟画圆</h2><blockquote><h3 id="查看小海龟节点的话题列表"><a href="#查看小海龟节点的话题列表" class="headerlink" title="查看小海龟节点的话题列表"></a>查看小海龟节点的话题列表</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic list -t</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_22.png"></p><h3 id="在-chapter-3-topic-ws-src-下创建包-demo-cpp-topic"><a href="#在-chapter-3-topic-ws-src-下创建包-demo-cpp-topic" class="headerlink" title="在 chapter_3&#x2F;topic_ws&#x2F;src&#x2F; 下创建包 demo_cpp_topic"></a>在 chapter_3&#x2F;topic_ws&#x2F;src&#x2F; 下创建包 demo_cpp_topic</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create demo_cpp_topic --build-type ament_cmake --dependencies rclcpp geometry_msgs turtlesim --license Apache-2.0</span><br></pre></td></tr></table></figure><h3 id="进入-demo-cpp-topic-src-创建-turtlesim-circle-cpp，其内容如下"><a href="#进入-demo-cpp-topic-src-创建-turtlesim-circle-cpp，其内容如下" class="headerlink" title="进入 demo_cpp_topic&#x2F;src 创建 turtlesim_circle.cpp，其内容如下"></a>进入 demo_cpp_topic&#x2F;src 创建 turtlesim_circle.cpp，其内容如下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/msg/twist.hpp&quot;</span><span class="comment">// 引入geometry_msgs中Twist消息类型，用于控制机器人速度</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span><span class="comment">// 引入chrono库用于处理时间</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std::chrono_literals;<span class="comment">// 方便使用时间单位如1s, 100ms等</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承 rclcpp::Node，表示一个ROS2节点</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TurtleCircleNode</span> : <span class="keyword">public</span> rclcpp::Node&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">// 定义定时器的智能指针，用于定时触发回调函数</span></span><br><span class="line">rclcpp::TimerBase::SharedPtr timer_;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 定义发布者的智能指针，用于发布Twist消息</span></span><br><span class="line">rclcpp::Publisher&lt;geometry_msgs::msg::Twist&gt;::SharedPtr publisher_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 构造函数，初始化节点并创建定时器和发布者</span></span><br><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">TurtleCircleNode</span><span class="params">(<span class="type">const</span> std::string &amp;node_name)</span> : Node(node_name)&#123;</span></span><br><span class="line"><span class="comment">// 创建发布者，负责将Twist消息发布到指定话题&quot;/turtle1/cmd_vel&quot;上，队列大小为10</span></span><br><span class="line">publisher_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_publisher</span>&lt;geometry_msgs::msg::Twist&gt;(<span class="string">&quot;/turtle1/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// 传入间隔周期，传入回调函数(可以使用成员函数作为回调函数，也可以使用 Lambda)</span></span><br><span class="line"><span class="comment">// 成员函数作为回调函数需要使用bind与当前对象进行绑定</span></span><br><span class="line"><span class="comment">// bind(param1, param2, param3) param1:函数的位置，param2:指向当前对象的指针, param3:参数列表占位符</span></span><br><span class="line">        <span class="comment">// 创建一个定时器，周期为1000ms（1秒），定时调用timer_callback()回调函数</span></span><br><span class="line">        <span class="comment">// 由于 timer_callback() 是一个不带参数的成员函数，所以参数列表中只有两个参数，如果成员函数有参数，那么bind的参数列表中也要相应的添加对应参数</span></span><br><span class="line">timer_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_wall_timer</span>(<span class="number">1000</span>ms, std::<span class="built_in">bind</span>(&amp;TurtleCircleNode::timer_callback, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 这里使用成员函数来作为回调函数</span></span><br><span class="line">    <span class="comment">// 定时器回调函数，按设定的周期触发</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">timer_callback</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">// 创建Twist消息对象</span></span><br><span class="line"><span class="keyword">auto</span> msg = geometry_msgs::msg::<span class="built_in">Twist</span>();</span><br><span class="line">        <span class="comment">// 设置线速度：x轴方向速度为1.0，y轴方向为0.0（不移动）</span></span><br><span class="line">msg.linear.x = <span class="number">1.0</span>;</span><br><span class="line">msg.linear.y = <span class="number">0.0</span>;</span><br><span class="line">        <span class="comment">// 设置角速度：z轴角速度为0.5，表示沿着Z轴旋转</span></span><br><span class="line">msg.angular.z = <span class="number">0.5</span>;</span><br><span class="line"><span class="comment">// 发布消息，通过发布者将控制命令发布出去</span></span><br><span class="line">publisher_-&gt;<span class="built_in">publish</span>(msg);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line"><span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;TurtleCircleNode&gt;(<span class="string">&quot;turtle_circle&quot;</span>);</span><br><span class="line">rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line"></span><br><span class="line">rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如果上面的回调函数使用-Lambda-表达式实现，则写成这样"><a href="#如果上面的回调函数使用-Lambda-表达式实现，则写成这样" class="headerlink" title="如果上面的回调函数使用 Lambda 表达式实现，则写成这样"></a>如果上面的回调函数使用 Lambda 表达式实现，则写成这样</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">timer_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_wall_timer</span>(</span><br><span class="line">    <span class="number">1000</span>ms, </span><br><span class="line">    [<span class="keyword">this</span>]() &#123; </span><br><span class="line">        <span class="comment">// Lambda 捕获当前对象，并在 Lambda 内部调用成员函数</span></span><br><span class="line">        <span class="keyword">auto</span> msg = geometry_msgs::msg::<span class="built_in">Twist</span>();</span><br><span class="line">        msg.linear.x = <span class="number">1.0</span>;</span><br><span class="line">        msg.linear.y = <span class="number">0.0</span>;</span><br><span class="line">        msg.angular.z = <span class="number">0.5</span>;</span><br><span class="line">        publisher_-&gt;<span class="built_in">publish</span>(msg);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-中添加相应语句"><a href="#在-CMakeLists-中添加相应语句" class="headerlink" title="在 CMakeLists 中添加相应语句"></a>在 CMakeLists 中添加相应语句</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(turtle_circle src/turtlesim_circle.cpp)</span><br><span class="line"><span class="comment"># 包含依赖</span></span><br><span class="line">ament_target_dependencies(turtle_circle rclcpp geometry_msgs)</span><br><span class="line"><span class="comment"># 拷贝节点到 install/lib 下</span></span><br><span class="line"><span class="keyword">install</span>(TARGETS turtle_circle</span><br><span class="line">DESTINATION lib/<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="编译并运行-先运行小海龟节点"><a href="#编译并运行-先运行小海龟节点" class="headerlink" title="编译并运行(先运行小海龟节点)"></a>编译并运行(先运行小海龟节点)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/learn_ros2/chapter_3/topic_ws/</span><br><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_cpp_topic turtle_circle</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_23.png"></p><h3 id="运行起来之后，在新的终端可以查看相关信息"><a href="#运行起来之后，在新的终端可以查看相关信息" class="headerlink" title="运行起来之后，在新的终端可以查看相关信息"></a>运行起来之后，在新的终端可以查看相关信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic list -t</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_24.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 node info /turtle_circle</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_25.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic echo /turtle1/cmd_vel</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_26.png"></p></blockquote><h2 id="订阅pose实现闭环控制"><a href="#订阅pose实现闭环控制" class="headerlink" title="订阅pose实现闭环控制"></a>订阅pose实现闭环控制</h2><blockquote><h3 id="查看当前节点的话题列表"><a href="#查看当前节点的话题列表" class="headerlink" title="查看当前节点的话题列表"></a>查看当前节点的话题列表</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic list -t</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_24.png"></p><h3 id="找到小海龟位置信息的话题，-turtle1-pose，对应的消息接口为-turtlesim-msg-Pose"><a href="#找到小海龟位置信息的话题，-turtle1-pose，对应的消息接口为-turtlesim-msg-Pose" class="headerlink" title="找到小海龟位置信息的话题，&#x2F;turtle1&#x2F;pose，对应的消息接口为 turtlesim&#x2F;msg&#x2F;Pose"></a>找到小海龟位置信息的话题，&#x2F;turtle1&#x2F;pose，对应的消息接口为 turtlesim&#x2F;msg&#x2F;Pose</h3><h3 id="查看消息接口的定义"><a href="#查看消息接口的定义" class="headerlink" title="查看消息接口的定义"></a>查看消息接口的定义</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 interface show turtlesim/msg/Pose</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_27.png"></p><h3 id="在-demo-cpp-topic-src-下创建文件-turtle-control-cpp，其内容如下"><a href="#在-demo-cpp-topic-src-下创建文件-turtle-control-cpp，其内容如下" class="headerlink" title="在 demo_cpp_topic&#x2F;src 下创建文件 turtle_control.cpp，其内容如下"></a>在 demo_cpp_topic&#x2F;src 下创建文件 turtle_control.cpp，其内容如下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;geometry_msgs/msg/twist.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;turtlesim/msg/pose.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std::chrono_literals;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TurtleControlNode</span> : <span class="keyword">public</span> rclcpp::Node&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">// 发布者的智能指针</span></span><br><span class="line">rclcpp::Publisher&lt;geometry_msgs::msg::Twist&gt;::SharedPtr publisher_;</span><br><span class="line">rclcpp::Subscription&lt;turtlesim::msg::Pose&gt;::SharedPtr subscriber_;</span><br><span class="line"><span class="type">double</span> target_x_&#123;<span class="number">1.0</span>&#125;;</span><br><span class="line"><span class="type">double</span> target_y_&#123;<span class="number">1.0</span>&#125;;</span><br><span class="line"><span class="type">double</span> k_&#123;<span class="number">1.0</span>&#125;;<span class="comment">// 比例系数</span></span><br><span class="line"><span class="type">double</span> max_speed_&#123;<span class="number">3.0</span>&#125;;<span class="comment">// 最大速度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">TurtleControlNode</span><span class="params">(<span class="type">const</span> std::string &amp;node_name)</span> : Node(node_name)&#123;</span></span><br><span class="line"><span class="comment">// 创建发布者</span></span><br><span class="line">publisher_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_publisher</span>&lt;geometry_msgs::msg::Twist&gt;(<span class="string">&quot;/turtle1/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line">subscriber_ = <span class="keyword">this</span>-&gt;<span class="built_in">create_subscription</span>&lt;turtlesim::msg::Pose&gt;(<span class="string">&quot;/turtle1/pose&quot;</span>, <span class="number">10</span>, std::<span class="built_in">bind</span>(&amp;TurtleControlNode::on_pose_received_, <span class="keyword">this</span>, std::placeholders::_1));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">on_pose_received_</span><span class="params">(<span class="type">const</span> turtlesim::msg::Pose::SharedPtr pose)</span></span>&#123;</span><br><span class="line"><span class="comment">// 获取小海龟当前位置</span></span><br><span class="line"><span class="type">double</span> current_x = pose-&gt;x;</span><br><span class="line"><span class="type">double</span> current_y = pose-&gt;y;</span><br><span class="line"><span class="built_in">RCLCPP_INFO</span>(<span class="built_in">get_logger</span>(), <span class="string">&quot;当前位置 x: %f,y: %f &quot;</span>, current_x, current_y);</span><br><span class="line"><span class="comment">// 计算当前位置与目标位置的距离差和角度差</span></span><br><span class="line"><span class="type">double</span> distance = std::<span class="built_in">sqrt</span>((target_x_ - current_x)*(target_x_ - current_x) + (target_y_ - current_y)*(target_y_ - current_y));</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> angle = std::<span class="built_in">atan2</span>((target_y_ - current_y), (target_x_ - current_x)) - pose-&gt;theta;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 控制策略</span></span><br><span class="line"><span class="keyword">auto</span> msg = geometry_msgs::msg::<span class="built_in">Twist</span>();</span><br><span class="line"><span class="keyword">if</span>(distance &gt; <span class="number">0.1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">fabs</span>(angle) &gt; <span class="number">0.2</span>)&#123;</span><br><span class="line">msg.angular.z = <span class="built_in">fabs</span>(angle);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">msg.linear.x = k_ * distance;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 限制线速度最大值</span></span><br><span class="line"><span class="keyword">if</span>(msg.linear.x &gt; max_speed_)&#123;</span><br><span class="line">msg.linear.x = max_speed_;</span><br><span class="line">&#125;</span><br><span class="line">publisher_-&gt;<span class="built_in">publish</span>(msg);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line"><span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;TurtleControlNode&gt;(<span class="string">&quot;turtle_control&quot;</span>);</span><br><span class="line">rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line"></span><br><span class="line">rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-文件中添加相应语句"><a href="#在-CMakeLists-文件中添加相应语句" class="headerlink" title="在 CMakeLists 文件中添加相应语句"></a>在 CMakeLists 文件中添加相应语句</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加可执行文件</span></span><br><span class="line">add_executable(turtle_control src/turtle_control.cpp)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加依赖</span></span><br><span class="line">ament_target_dependencies(turtle_control rclcpp geometry_msgs turtlesim)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝节点到 install/lib</span></span><br><span class="line">install(TARGETS turtle_circle turtle_control</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="编译运行-先运行-turtle-节点"><a href="#编译运行-先运行-turtle-节点" class="headerlink" title="编译运行(先运行 turtle 节点)"></a>编译运行(先运行 turtle 节点)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/learn_ros2/chapter_3/topic_ws/</span><br><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_cpp_topic turtle_control</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_28.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第八弹</title>
      <link href="/2025/02/20/10/"/>
      <url>/2025/02/20/10/</url>
      
        <content type="html"><![CDATA[<h1 id="话题"><a href="#话题" class="headerlink" title="话题"></a>话题</h1><h3 id="一个话题包含了发布节点、订阅节点、话题名称和话题类型四个方面"><a href="#一个话题包含了发布节点、订阅节点、话题名称和话题类型四个方面" class="headerlink" title="一个话题包含了发布节点、订阅节点、话题名称和话题类型四个方面"></a>一个话题包含了发布节点、订阅节点、话题名称和话题类型四个方面</h3><blockquote><h3 id="小海龟示例"><a href="#小海龟示例" class="headerlink" title="小海龟示例"></a>小海龟示例</h3><h3 id="启动小海龟模拟器"><a href="#启动小海龟模拟器" class="headerlink" title="启动小海龟模拟器"></a>启动小海龟模拟器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 run turtlesim turtlesim_node</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_15.png"></p><h3 id="然后在同一路径下打开一个新的终端"><a href="#然后在同一路径下打开一个新的终端" class="headerlink" title="然后在同一路径下打开一个新的终端"></a>然后在同一路径下打开一个新的终端</h3><h3 id="查看当前运行的节点列表"><a href="#查看当前运行的节点列表" class="headerlink" title="查看当前运行的节点列表"></a>查看当前运行的节点列表</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 node list</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_16.png"></p><h3 id="查看当前运行节点的信息"><a href="#查看当前运行节点的信息" class="headerlink" title="查看当前运行节点的信息"></a>查看当前运行节点的信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 node info /turtlesim</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_17.png"></p><h3 id="其中，订阅者里的-turtle1-cmd-vel-话题是负责控制小海龟的，发布者里的-turtle1-pose-是小海龟的实时位置信息"><a href="#其中，订阅者里的-turtle1-cmd-vel-话题是负责控制小海龟的，发布者里的-turtle1-pose-是小海龟的实时位置信息" class="headerlink" title="其中，订阅者里的 &#x2F;turtle1&#x2F;cmd_vel 话题是负责控制小海龟的，发布者里的 &#x2F;turtle1&#x2F;pose 是小海龟的实时位置信息"></a>其中，订阅者里的 &#x2F;turtle1&#x2F;cmd_vel 话题是负责控制小海龟的，发布者里的 &#x2F;turtle1&#x2F;pose 是小海龟的实时位置信息</h3><h3 id="输出小海龟位置信息"><a href="#输出小海龟位置信息" class="headerlink" title="输出小海龟位置信息"></a>输出小海龟位置信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic echo /turtle1/pose</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_18.png"></p><h3 id="小海龟的位置信息包含五个参数，坐标-x-y-，头的朝向的角度-theta，线速度-linear-velocity，角速度-angular-velocity"><a href="#小海龟的位置信息包含五个参数，坐标-x-y-，头的朝向的角度-theta，线速度-linear-velocity，角速度-angular-velocity" class="headerlink" title="小海龟的位置信息包含五个参数，坐标(x, y)，头的朝向的角度 theta，线速度 linear_velocity，角速度 angular_velocity"></a>小海龟的位置信息包含五个参数，坐标(x, y)，头的朝向的角度 theta，线速度 linear_velocity，角速度 angular_velocity</h3><h3 id="获取某个话题的消息接口"><a href="#获取某个话题的消息接口" class="headerlink" title="获取某个话题的消息接口"></a>获取某个话题的消息接口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic info /turtle1/cmd_vel</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_19.png"></p><h3 id="查看接口的详细定义"><a href="#查看接口的详细定义" class="headerlink" title="查看接口的详细定义"></a>查看接口的详细定义</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 interface show geometry_msgs/msg/Twist</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_20.png"></p><h3 id="在确认某个节点的消息接口之后，可以直接对话题发布数据"><a href="#在确认某个节点的消息接口之后，可以直接对话题发布数据" class="headerlink" title="在确认某个节点的消息接口之后，可以直接对话题发布数据"></a>在确认某个节点的消息接口之后，可以直接对话题发布数据</h3><h3 id="turtle1-cmd-vel-是话题名，geometry-msgs-msg-Twist-消息接口，后面是-yaml-格式的数据，"><a href="#turtle1-cmd-vel-是话题名，geometry-msgs-msg-Twist-消息接口，后面是-yaml-格式的数据，" class="headerlink" title="&#x2F;turtle1&#x2F;cmd_vel 是话题名，geometry_msgs&#x2F;msg&#x2F;Twist 消息接口，后面是 yaml 格式的数据，"></a>&#x2F;turtle1&#x2F;cmd_vel 是话题名，geometry_msgs&#x2F;msg&#x2F;Twist 消息接口，后面是 yaml 格式的数据，</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 topic pub /turtle1/cmd_vel geometry_msgs/msg/Twist &quot;&#123;linear: &#123;x: 0.5, y: 0.0&#125; , angular: &#123;z: 0.0&#125;&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="如果同一时刻，有多个终端对该消息接口发布数据，那么小海龟的运动就会变得奇怪起来"><a href="#如果同一时刻，有多个终端对该消息接口发布数据，那么小海龟的运动就会变得奇怪起来" class="headerlink" title="如果同一时刻，有多个终端对该消息接口发布数据，那么小海龟的运动就会变得奇怪起来"></a>如果同一时刻，有多个终端对该消息接口发布数据，那么小海龟的运动就会变得奇怪起来</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_21.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu使用</title>
      <link href="/2025/02/19/09/"/>
      <url>/2025/02/19/09/</url>
      
        <content type="html"><![CDATA[<h1 id="Ubuntu-换源"><a href="#Ubuntu-换源" class="headerlink" title="Ubuntu 换源"></a>Ubuntu 换源</h1><h3 id="在使用-sudo-apt-get-update-和-sudo-apt-get-upgrade-进行更新时，可能下载会很慢，这个时候使用国内的镜像资源可能会明显提升下载速度。"><a href="#在使用-sudo-apt-get-update-和-sudo-apt-get-upgrade-进行更新时，可能下载会很慢，这个时候使用国内的镜像资源可能会明显提升下载速度。" class="headerlink" title="在使用 sudo apt-get update 和 sudo apt-get upgrade 进行更新时，可能下载会很慢，这个时候使用国内的镜像资源可能会明显提升下载速度。"></a>在使用 sudo apt-get update 和 sudo apt-get upgrade 进行更新时，可能下载会很慢，这个时候使用国内的镜像资源可能会明显提升下载速度。</h3><blockquote><h3 id="先是要备份原来的源文件"><a href="#先是要备份原来的源文件" class="headerlink" title="先是要备份原来的源文件"></a>先是要备份原来的源文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure><h3 id="再编辑-sources-list-文件"><a href="#再编辑-sources-list-文件" class="headerlink" title="再编辑 sources.list 文件"></a>再编辑 sources.list 文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure><h3 id="这里使用阿里云的镜像"><a href="#这里使用阿里云的镜像" class="headerlink" title="这里使用阿里云的镜像"></a>这里使用阿里云的镜像</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://mirrors.aliyun.com/ubuntu/</span><br></pre></td></tr></table></figure><h3 id="替换后，再进行更新"><a href="#替换后，再进行更新" class="headerlink" title="替换后，再进行更新"></a>替换后，再进行更新</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第七弹</title>
      <link href="/2025/02/18/08/"/>
      <url>/2025/02/18/08/</url>
      
        <content type="html"><![CDATA[<h1 id="多线程与回调函数"><a href="#多线程与回调函数" class="headerlink" title="多线程与回调函数"></a>多线程与回调函数</h1><h3 id="需要下载一个-cpp-httplib-，下载到-workspace-src-demo-one-pkg-include"><a href="#需要下载一个-cpp-httplib-，下载到-workspace-src-demo-one-pkg-include" class="headerlink" title="需要下载一个 cpp-httplib ，下载到 workspace&#x2F;src&#x2F;demo_one_pkg&#x2F;include&#x2F;"></a>需要下载一个 cpp-httplib ，下载到 workspace&#x2F;src&#x2F;demo_one_pkg&#x2F;include&#x2F;</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitee.com/ohhuo/cpp-httplib.git</span><br></pre></td></tr></table></figure><h3 id="下载后得到如下文件"><a href="#下载后得到如下文件" class="headerlink" title="下载后得到如下文件"></a>下载后得到如下文件</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_12.png"></p></blockquote><h3 id="下载好之后，修改-demo-one-pkg-的-CMakeLists-文件"><a href="#下载好之后，修改-demo-one-pkg-的-CMakeLists-文件" class="headerlink" title="下载好之后，修改 demo_one_pkg 的 CMakeLists 文件"></a>下载好之后，修改 demo_one_pkg 的 CMakeLists 文件</h3><blockquote><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 包含 cpp-httplib 的 include</span></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="keyword">include</span>)</span><br></pre></td></tr></table></figure></blockquote><h3 id="接着，在-demo-one-pkg-src-下创建-learn-thread-cpp，内容如下"><a href="#接着，在-demo-one-pkg-src-下创建-learn-thread-cpp，内容如下" class="headerlink" title="接着，在 demo_one_pkg&#x2F;src 下创建 learn_thread.cpp，内容如下"></a>接着，在 demo_one_pkg&#x2F;src 下创建 learn_thread.cpp，内容如下</h3><blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span><span class="comment">// 多线程</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span><span class="comment">// 时间相关</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span><span class="comment">// 函数包装器</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cpp-httplib/httplib.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;future&gt;</span><span class="comment">// 用于 std::async 处理异步任务</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Download</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">// 下载函数,负责下载文件并调用回调函数</span></span><br><span class="line"><span class="comment">// host 主机， path 路径，回调函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">download</span><span class="params">(<span class="type">const</span> std::string&amp; host, <span class="type">const</span> std::string&amp; path, <span class="type">const</span> std::function&lt;<span class="type">void</span>(<span class="type">const</span> std::string &amp;, <span class="type">const</span> std::string &amp;)&gt; &amp;callback_word_count)</span></span>&#123;</span><br><span class="line"><span class="comment">// 输出当前线程ID，便于调试</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;线程编号： &quot;</span> &lt;&lt; std::this_thread::<span class="built_in">get_id</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="comment">// 创建客户端对象，指定主机</span></span><br><span class="line"><span class="function">httplib::Client <span class="title">client</span><span class="params">(host)</span></span>;</span><br><span class="line"><span class="comment">// 发送 GET 请求，获取文件内容</span></span><br><span class="line"><span class="keyword">auto</span> response = client.<span class="built_in">Get</span>(path);</span><br><span class="line"><span class="comment">// 如果请求成功且状态码为200</span></span><br><span class="line"><span class="keyword">if</span>(response &amp;&amp; response-&gt;status == <span class="number">200</span>)&#123;</span><br><span class="line"><span class="comment">// 调用回调函数并传递文件内容</span></span><br><span class="line"><span class="built_in">callback_word_count</span>(path, response-&gt;body);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 启动下载函数,使用 std::async 异步执行下载任务</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start_download</span><span class="params">(<span class="type">const</span> std::string&amp; host, <span class="type">const</span> std::string&amp; path, <span class="type">const</span> std::function&lt;<span class="type">void</span>(<span class="type">const</span> std::string &amp;, <span class="type">const</span> std::string &amp;)&gt; &amp;callback_word_count)</span></span>&#123;</span><br><span class="line"><span class="comment">// 函数包装器进行包装</span></span><br><span class="line"><span class="comment">// auto download_fun = std::bind(&amp;Download::start_download, this, std::placeholders::_1, std::placeholders::_2, std::placeholders::_3);</span></span><br><span class="line"><span class="comment">// 创建线程</span></span><br><span class="line"><span class="comment">// std::thread thread(download_fun, host, path, callback_word_count);</span></span><br><span class="line"><span class="comment">// 等待线程结束</span></span><br><span class="line"><span class="comment">// thread.join();</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">// 直接通过 std::async 可以异步执行任务，同时它会返回一个 std::future 对象，保证任务的异步执行，而主线程会等待任务完成</span></span><br><span class="line"><span class="comment">// std::launch::async 会指示 std::async 强制使用新的线程执行任务</span></span><br><span class="line"><span class="keyword">auto</span> future = std::<span class="built_in">async</span>(std::launch::async, [=]()&#123;</span><br><span class="line"><span class="built_in">download</span>(host, path, callback_word_count);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> d = <span class="built_in">Download</span>();</span><br><span class="line"><span class="comment">// 创建回调函数, path 地址， result 结果</span></span><br><span class="line"><span class="keyword">auto</span> word_count = [](<span class="type">const</span> std::string &amp;path, <span class="type">const</span> std::string &amp;result) -&gt; <span class="type">void</span>&#123;</span><br><span class="line"><span class="comment">// 输出文件路径，文件内容的长度，以及文件内容的前五个字符</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;下载完成 &quot;</span> &lt;&lt; path &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; result.<span class="built_in">length</span>() &lt;&lt; <span class="string">&quot; -&gt; &quot;</span> &lt;&lt; result.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">5</span>) &lt;&lt; std::endl;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动多个下载任务，分别下载 novel1.txt、novel2.txt 和 novel3.txt</span></span><br><span class="line">d.<span class="built_in">start_download</span>(<span class="string">&quot;http://0.0.0.0:8080&quot;</span>, <span class="string">&quot;/novel1.txt&quot;</span>, word_count);</span><br><span class="line">d.<span class="built_in">start_download</span>(<span class="string">&quot;http://0.0.0.0:8080&quot;</span>, <span class="string">&quot;/novel2.txt&quot;</span>, word_count);</span><br><span class="line">d.<span class="built_in">start_download</span>(<span class="string">&quot;http://0.0.0.0:8080&quot;</span>, <span class="string">&quot;/novel3.txt&quot;</span>, word_count);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主线程休眠10秒，确保所有异步线程有足够时间完成下载任务</span></span><br><span class="line">std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">milliseconds</span>(<span class="number">1000</span>*<span class="number">10</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="这里需要注意的是-std-async-的用法"><a href="#这里需要注意的是-std-async-的用法" class="headerlink" title="这里需要注意的是 std::async 的用法"></a>这里需要注意的是 std::async 的用法</h3><blockquote><h3 id="它是-C-11-引入的一个标准库函数，用于启动异步任务。它接受一个可调用对象（比如函数、函数指针、Lambda-表达式等）和一些参数，并返回一个-std-future-对象，表示异步操作的结果。"><a href="#它是-C-11-引入的一个标准库函数，用于启动异步任务。它接受一个可调用对象（比如函数、函数指针、Lambda-表达式等）和一些参数，并返回一个-std-future-对象，表示异步操作的结果。" class="headerlink" title="它是 C++11 引入的一个标准库函数，用于启动异步任务。它接受一个可调用对象（比如函数、函数指针、Lambda 表达式等）和一些参数，并返回一个 std::future 对象，表示异步操作的结果。"></a>它是 C++11 引入的一个标准库函数，用于启动异步任务。它接受一个可调用对象（比如函数、函数指针、Lambda 表达式等）和一些参数，并返回一个 std::future 对象，表示异步操作的结果。</h3><h3 id="语法如下"><a href="#语法如下" class="headerlink" title="语法如下"></a>语法如下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::future&lt;T&gt; <span class="title">async</span><span class="params">(std::launch policy, F&amp;&amp; f, Args&amp;&amp;... args)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="std-launch-指定任务的执行策略，如-std-launch-async-或-std-launch-deferred。前者是任务会异步启动并在独立的线程中执行后者是任务会被推迟执行，直到调用-future-get-时，才会在当前线程中执行。"><a href="#std-launch-指定任务的执行策略，如-std-launch-async-或-std-launch-deferred。前者是任务会异步启动并在独立的线程中执行后者是任务会被推迟执行，直到调用-future-get-时，才会在当前线程中执行。" class="headerlink" title="std::launch 指定任务的执行策略，如 std::launch::async 或 std::launch::deferred。前者是任务会异步启动并在独立的线程中执行后者是任务会被推迟执行，直到调用 future.get() 时，才会在当前线程中执行。"></a>std::launch 指定任务的执行策略，如 std::launch::async 或 std::launch::deferred。前者是任务会异步启动并在独立的线程中执行后者是任务会被推迟执行，直到调用 future.get() 时，才会在当前线程中执行。</h3><h3 id="Lambda-表达式"><a href="#Lambda-表达式" class="headerlink" title="Lambda 表达式"></a>Lambda 表达式</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[捕获列表](参数列表) -&gt; 返回类型 &#123; 函数体 &#125;</span><br></pre></td></tr></table></figure><h3 id="：按值捕获外部变量"><a href="#：按值捕获外部变量" class="headerlink" title="[&#x3D;] ：按值捕获外部变量"></a>[&#x3D;] ：按值捕获外部变量</h3><h3 id="按引用捕获外部变量"><a href="#按引用捕获外部变量" class="headerlink" title="[&amp;] : 按引用捕获外部变量"></a>[&amp;] : 按引用捕获外部变量</h3></blockquote></blockquote><h3 id="在-CMakeLists-文件中添加相应语句"><a href="#在-CMakeLists-文件中添加相应语句" class="headerlink" title="在 CMakeLists 文件中添加相应语句"></a>在 CMakeLists 文件中添加相应语句</h3><blockquote><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(learn_thread src/learn_thread.cpp)</span><br><span class="line"><span class="comment"># 将节点拷贝到install</span></span><br><span class="line"><span class="keyword">install</span>(TARGETS demo_one_node person_node learn_shared_ptr learn_lambda learn_functional learn_thread</span><br><span class="line">DESTINATION lib/<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></blockquote><h3 id="在-chapter2-ws-目录下创建三个-txt-文件，并写入简单的内容，然后在该路径下运行本地服务器，并保持打开状态"><a href="#在-chapter2-ws-目录下创建三个-txt-文件，并写入简单的内容，然后在该路径下运行本地服务器，并保持打开状态" class="headerlink" title="在 chapter2_ws 目录下创建三个 txt 文件，并写入简单的内容，然后在该路径下运行本地服务器，并保持打开状态"></a>在 chapter2_ws 目录下创建三个 txt 文件，并写入简单的内容，然后在该路径下运行本地服务器，并保持打开状态</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;第一章 hello word&quot; &gt; novel1.txt</span><br><span class="line">echo &quot;第二章 hello guys&quot; &gt; novel2.txt</span><br><span class="line">echo &quot;第三章 hello girls&quot; &gt; novel3.txt</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_13.png"></p></blockquote><h3 id="在同一路径下打开另外一个终端，编译并执行-learn-thread-节点"><a href="#在同一路径下打开另外一个终端，编译并执行-learn-thread-节点" class="headerlink" title="在同一路径下打开另外一个终端，编译并执行 learn_thread 节点"></a>在同一路径下打开另外一个终端，编译并执行 learn_thread 节点</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_one_pkg learn_thread</span><br></pre></td></tr></table></figure><h3 id="执行后会得到如下输出"><a href="#执行后会得到如下输出" class="headerlink" title="执行后会得到如下输出"></a>执行后会得到如下输出</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_14.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第六弹</title>
      <link href="/2025/02/17/07/"/>
      <url>/2025/02/17/07/</url>
      
        <content type="html"><![CDATA[<h1 id="ROS2-中，cpp新特性的应用"><a href="#ROS2-中，cpp新特性的应用" class="headerlink" title="ROS2 中，cpp新特性的应用"></a>ROS2 中，cpp新特性的应用</h1><h3 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h3><blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// auto 自动推导类型</span></span><br><span class="line"><span class="keyword">auto</span> a = <span class="number">1</span>; <span class="comment">// int a = 1</span></span><br></pre></td></tr></table></figure></blockquote><h3 id="智能指针"><a href="#智能指针" class="headerlink" title="智能指针"></a>智能指针</h3><blockquote><h3 id="智能指针分为三种"><a href="#智能指针分为三种" class="headerlink" title="智能指针分为三种"></a>智能指针分为三种</h3><ul><li><h4 id="shared-ptr-共享的智能指针"><a href="#shared-ptr-共享的智能指针" class="headerlink" title="shared_ptr 共享的智能指针"></a>shared_ptr 共享的智能指针</h4></li><li><h4 id="weak-ptr-弱引用的智能指针"><a href="#weak-ptr-弱引用的智能指针" class="headerlink" title="weak_ptr 弱引用的智能指针"></a>weak_ptr 弱引用的智能指针</h4></li><li><h4 id="unique-ptr-独占的智能指针"><a href="#unique-ptr-独占的智能指针" class="headerlink" title="unique_ptr 独占的智能指针"></a>unique_ptr 独占的智能指针</h4></li></ul><h3 id="std-shared-ptr-是一个类模板，它的对象的行为类似于指针，它可以记录共享它所管理的内存对象的对象个数。多个共享指针可以共享同一个对象，当最后一个共享指针被销毁时，会自动释放其所指向的对象。一个共享指针通常使用-make-shared-来创建，也可以通过拷贝或者赋值其他共享指针的方式创建。"><a href="#std-shared-ptr-是一个类模板，它的对象的行为类似于指针，它可以记录共享它所管理的内存对象的对象个数。多个共享指针可以共享同一个对象，当最后一个共享指针被销毁时，会自动释放其所指向的对象。一个共享指针通常使用-make-shared-来创建，也可以通过拷贝或者赋值其他共享指针的方式创建。" class="headerlink" title="std::shared_ptr 是一个类模板，它的对象的行为类似于指针，它可以记录共享它所管理的内存对象的对象个数。多个共享指针可以共享同一个对象，当最后一个共享指针被销毁时，会自动释放其所指向的对象。一个共享指针通常使用 make_shared&lt;&gt; 来创建，也可以通过拷贝或者赋值其他共享指针的方式创建。"></a>std::shared_ptr<T> 是一个类模板，它的对象的行为类似于指针，它可以记录共享它所管理的内存对象的对象个数。多个共享指针可以共享同一个对象，当最后一个共享指针被销毁时，会自动释放其所指向的对象。一个共享指针通常使用 make_shared&lt;&gt; 来创建，也可以通过拷贝或者赋值其他共享指针的方式创建。</h3><h3 id="代码示例，在-demo-one-pkg-src-下创建-learn-shared-ptr-cpp"><a href="#代码示例，在-demo-one-pkg-src-下创建-learn-shared-ptr-cpp" class="headerlink" title="代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_shared_ptr.cpp"></a>代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_shared_ptr.cpp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建共享智能指针 &lt;数据类型/类&gt;(参数) 返回值，对应类的共享指针</span></span><br><span class="line"><span class="keyword">auto</span> p1 = std::<span class="built_in">make_shared</span>&lt;std::string&gt;(<span class="string">&quot;This is a string.&quot;</span>);</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p1的引用计数: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;, 指向内存地址: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">get</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> p2 = p1;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p1的引用计数: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;, 指向内存地址: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">get</span>() &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p2的引用计数: &quot;</span> &lt;&lt; p<span class="number">2.</span><span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;, 指向内存地址: &quot;</span> &lt;&lt; p<span class="number">2.</span><span class="built_in">get</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 释放引用</span></span><br><span class="line">p<span class="number">1.</span><span class="built_in">reset</span>();</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p1的引用计数: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;, 指向内存地址: &quot;</span> &lt;&lt; p<span class="number">1.</span><span class="built_in">get</span>() &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p2的引用计数: &quot;</span> &lt;&lt; p<span class="number">2.</span><span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;, 指向内存地址: &quot;</span> &lt;&lt; p<span class="number">2.</span><span class="built_in">get</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// p2-&gt;c_str() 调用成员函数</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;p2的指向内存地址数据: &quot;</span> &lt;&lt; p2-&gt;<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-文件中添加"><a href="#在-CMakeLists-文件中添加" class="headerlink" title="在 CMakeLists 文件中添加"></a>在 CMakeLists 文件中添加</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 添加可执行文件</span><br><span class="line">add_executable(learn_shared_ptr src/learn_shared_ptr.cpp)</span><br><span class="line"># 拷贝节点到install</span><br><span class="line">install(TARGETS demo_one_node person_node learn_shared_ptr</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="编译并执行"><a href="#编译并执行" class="headerlink" title="编译并执行"></a>编译并执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_one_pkg learn_shared_ptr</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_9.png"></p></blockquote><h3 id="Lambda-表达式"><a href="#Lambda-表达式" class="headerlink" title="Lambda 表达式"></a>Lambda 表达式</h3><blockquote><h3 id="可以利用它来编写内嵌的匿名函数，用以替换独立函数或函数对象。"><a href="#可以利用它来编写内嵌的匿名函数，用以替换独立函数或函数对象。" class="headerlink" title="可以利用它来编写内嵌的匿名函数，用以替换独立函数或函数对象。"></a>可以利用它来编写内嵌的匿名函数，用以替换独立函数或函数对象。</h3><h3 id="代码示例，在-demo-one-pkg-src-下创建-learn-lambda-cpp"><a href="#代码示例，在-demo-one-pkg-src-下创建-learn-lambda-cpp" class="headerlink" title="代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_lambda.cpp"></a>代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_lambda.cpp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [] 是捕获参数列表，() 中放置参数，&#123;&#125; 中是函数体， -&gt; 后面是返回类型</span></span><br><span class="line"><span class="keyword">auto</span> add = [](<span class="type">int</span> a, <span class="type">int</span> b) -&gt; <span class="type">int</span> &#123;<span class="keyword">return</span> a + b;&#125;;</span><br><span class="line"><span class="type">int</span> sum = <span class="built_in">add</span>(<span class="number">200</span>, <span class="number">50</span>);</span><br><span class="line"><span class="comment">// 这里的 [sum] 可以替换为 [&amp;]，后者可以捕获其之前的所有参数</span></span><br><span class="line"><span class="keyword">auto</span> print_sum = [sum]() -&gt; <span class="type">void</span> &#123;std::cout &lt;&lt; sum &lt;&lt; std::endl;&#125;;</span><br><span class="line"><span class="built_in">print_sum</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-文件中添加-1"><a href="#在-CMakeLists-文件中添加-1" class="headerlink" title="在 CMakeLists 文件中添加"></a>在 CMakeLists 文件中添加</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 添加可执行文件</span><br><span class="line">add_executable(learn_lambda src/learn_lambda.cpp)</span><br><span class="line"># 拷贝节点到install</span><br><span class="line">install(TARGETS demo_one_node person_node learn_shared_ptr learn_lambda</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="编译并执行-1"><a href="#编译并执行-1" class="headerlink" title="编译并执行"></a>编译并执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_one_pkg learn_lambda</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_10.png"></p></blockquote><h3 id="函数包装器"><a href="#函数包装器" class="headerlink" title="函数包装器"></a>函数包装器</h3><blockquote><h3 id="cpp-中函数可大致分为三类，一类是自由函数，一类是成员函数，另外一类就是-Lambda函数。三种函数的调用方式不同，自由函数直接函数名加参数调用，成员函数需要对象来调用。函数包装器就是用于统一这三种函数的调用方式的。"><a href="#cpp-中函数可大致分为三类，一类是自由函数，一类是成员函数，另外一类就是-Lambda函数。三种函数的调用方式不同，自由函数直接函数名加参数调用，成员函数需要对象来调用。函数包装器就是用于统一这三种函数的调用方式的。" class="headerlink" title="cpp 中函数可大致分为三类，一类是自由函数，一类是成员函数，另外一类就是 Lambda函数。三种函数的调用方式不同，自由函数直接函数名加参数调用，成员函数需要对象来调用。函数包装器就是用于统一这三种函数的调用方式的。"></a>cpp 中函数可大致分为三类，一类是自由函数，一类是成员函数，另外一类就是 Lambda函数。三种函数的调用方式不同，自由函数直接函数名加参数调用，成员函数需要对象来调用。函数包装器就是用于统一这三种函数的调用方式的。</h3><h3 id="代码示例，在-demo-one-pkg-src-下创建-learn-functional-cpp"><a href="#代码示例，在-demo-one-pkg-src-下创建-learn-functional-cpp" class="headerlink" title="代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_functional.cpp"></a>代码示例，在 demo_one_pkg&#x2F;src&#x2F; 下创建 learn_functional.cpp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span><span class="comment">// 函数包装器头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自由函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save_with_free_fun</span><span class="params">(<span class="type">const</span> std::string &amp; file_name)</span></span>&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;自由函数: &quot;</span> &lt;&lt; file_name &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FileSave</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">FileSave</span>() = <span class="keyword">default</span>;</span><br><span class="line">~<span class="built_in">FileSave</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成员函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save_with_member_fun</span><span class="params">(<span class="type">const</span> std::string &amp; file_name)</span></span>&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;成员函数: &quot;</span> &lt;&lt; file_name &lt;&lt; std::endl;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">FileSave file_save;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lambda 函数</span></span><br><span class="line"><span class="keyword">auto</span> save_with_lambda_fun = [](<span class="type">const</span> std::string &amp; file_name) -&gt; <span class="type">void</span> &#123;std::cout &lt;&lt; <span class="string">&quot;Lambda 函数: &quot;</span> &lt;&lt; file_name &lt;&lt; std::endl;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 未统一调用</span></span><br><span class="line"><span class="built_in">save_with_free_fun</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line">file_save.<span class="built_in">save_with_member_fun</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line"><span class="built_in">save_with_lambda_fun</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用函数包装器统一调用</span></span><br><span class="line">std::function&lt;<span class="type">void</span>(<span class="type">const</span> std::string&amp;)&gt;save1 = save_with_free_fun;</span><br><span class="line"><span class="comment">// 成员函数放入包装器较为复杂，涉及三个参数</span></span><br><span class="line">std::function&lt;<span class="type">void</span>(<span class="type">const</span> std::string&amp;)&gt;save2 = std::<span class="built_in">bind</span>(&amp;FileSave::save_with_member_fun, &amp;file_save, std::placeholders::_1);</span><br><span class="line">std::function&lt;<span class="type">void</span>(<span class="type">const</span> std::string&amp;)&gt;save3 = save_with_lambda_fun;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="built_in">save1</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line"><span class="built_in">save2</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line"><span class="built_in">save3</span>(<span class="string">&quot;file.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在-CMakeLists-文件中添加-2"><a href="#在-CMakeLists-文件中添加-2" class="headerlink" title="在 CMakeLists 文件中添加"></a>在 CMakeLists 文件中添加</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 添加可执行文件</span><br><span class="line">add_executable(learn_functional src/learn_functional.cpp)</span><br><span class="line"># 拷贝节点到install</span><br><span class="line">install(TARGETS demo_one_node person_node learn_shared_ptr learn_lambda learn_functional</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="编译并执行-2"><a href="#编译并执行-2" class="headerlink" title="编译并执行"></a>编译并执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run demo_one_pkg learn_functional</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_11.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第五弹</title>
      <link href="/2025/02/17/06/"/>
      <url>/2025/02/17/06/</url>
      
        <content type="html"><![CDATA[<h1 id="ROS2基础：cpp面向对象编程"><a href="#ROS2基础：cpp面向对象编程" class="headerlink" title="ROS2基础：cpp面向对象编程"></a>ROS2基础：cpp面向对象编程</h1><h3 id="在-chapter2-ws-sec-demo-one-pkg-src-下创建一个-person-node-cpp"><a href="#在-chapter2-ws-sec-demo-one-pkg-src-下创建一个-person-node-cpp" class="headerlink" title="在 chapter2_ws&#x2F;sec&#x2F;demo_one_pkg&#x2F;src 下创建一个 person_node.cpp"></a>在 chapter2_ws&#x2F;sec&#x2F;demo_one_pkg&#x2F;src 下创建一个 person_node.cpp</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd chapter2_ws/src/demo_one_pkg/src</span><br><span class="line">touch person_node.cpp</span><br><span class="line">gedit person_node.cpp</span><br></pre></td></tr></table></figure></blockquote><h3 id="然后，编辑-person-node-cpp-的内容"><a href="#然后，编辑-person-node-cpp-的内容" class="headerlink" title="然后，编辑 person_node.cpp 的内容"></a>然后，编辑 person_node.cpp 的内容</h3><blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类，使其继承 Node</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonNode</span> : <span class="keyword">public</span> rclcpp::Node&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">std::string name_;</span><br><span class="line"><span class="type">int</span> age_;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">// 构造函数,调用父类的构造函数,属性初始化</span></span><br><span class="line"><span class="built_in">PersonNode</span>(<span class="type">const</span> std::string &amp;node_name, <span class="type">const</span> std::string &amp;name, <span class="type">const</span> <span class="type">int</span> &amp;age):<span class="built_in">Node</span>(node_name)&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;name_ = name;</span><br><span class="line"><span class="keyword">this</span>-&gt;age_ = age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">eat</span><span class="params">(<span class="type">const</span> std::string &amp;food_name)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 这里用的是 C 的格式化输出，故需要将 name_ 转换为 C 风格的字符串</span></span><br><span class="line"><span class="built_in">RCLCPP_INFO</span>(<span class="keyword">this</span>-&gt;<span class="built_in">get_logger</span>(), <span class="string">&quot;I&#x27;m %s, %d years old and love eatting %s&quot;</span>, <span class="keyword">this</span>-&gt;name_.<span class="built_in">c_str</span>(), <span class="keyword">this</span>-&gt;age_, food_name.<span class="built_in">c_str</span>());</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span>&#123;</span><br><span class="line">rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line"><span class="comment">// 这里的 make_shared 需要修改为 PersonNode 类型,传入的参数个数和形式必须与上面的PersonNode的一致</span></span><br><span class="line"><span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;PersonNode&gt;(<span class="string">&quot;person_node&quot;</span>,<span class="string">&quot;Peter&quot;</span>,<span class="number">18</span>);</span><br><span class="line"><span class="built_in">RCLCPP_INFO</span>(node-&gt;<span class="built_in">get_logger</span>(),<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="comment">// 如果上面的 make_shared 不修改为 PersonNode 类型，那么这里无法调用其公共函数</span></span><br><span class="line">node-&gt;<span class="built_in">eat</span>(<span class="string">&quot;apple&quot;</span>);</span><br><span class="line">rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line">rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h3 id="修改-demo-one-pkg-的-CmakeLists-文件"><a href="#修改-demo-one-pkg-的-CmakeLists-文件" class="headerlink" title="修改 demo_one_pkg 的 CmakeLists 文件"></a>修改 demo_one_pkg 的 CmakeLists 文件</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加可执行文件</span></span><br><span class="line">add_executable(demo_one_node src/demo_one.cpp)</span><br><span class="line">add_executable(person_node src/person_node.cpp)# 添加这句</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加依赖</span></span><br><span class="line">ament_target_dependencies(demo_one_node rclcpp)</span><br><span class="line">ament_target_dependencies(person_node rclcpp)# 添加这句</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝节点到 install</span></span><br><span class="line">install(TARGETS demo_one_node person_node</span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></blockquote><h3 id="重新编译并执行"><a href="#重新编译并执行" class="headerlink" title="重新编译并执行"></a>重新编译并执行</h3><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ./learn_ros2/chapter_2/chapter2_ws/</span><br><span class="line">colcon build</span><br><span class="line">ros2 run demo_one_pkg person_node</span><br></pre></td></tr></table></figure><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_8.png"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第四弹</title>
      <link href="/2025/01/03/05/"/>
      <url>/2025/01/03/05/</url>
      
        <content type="html"><![CDATA[<h1 id="使用功能包组织cpp节点"><a href="#使用功能包组织cpp节点" class="headerlink" title="使用功能包组织cpp节点"></a>使用功能包组织cpp节点</h1><blockquote><h3 id="创建一个功能包，这里所在的目录是-learn-ros2-chapter-2"><a href="#创建一个功能包，这里所在的目录是-learn-ros2-chapter-2" class="headerlink" title="创建一个功能包，这里所在的目录是  ~&#x2F;learn_ros2&#x2F;chapter_2&#x2F;"></a>创建一个功能包，这里所在的目录是  ~&#x2F;learn_ros2&#x2F;chapter_2&#x2F;</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create demo_one_pkg --build-type ament_cmake --license Apache-2.0</span><br></pre></td></tr></table></figure><h3 id="创建好之后显示以下信息，"><a href="#创建好之后显示以下信息，" class="headerlink" title="创建好之后显示以下信息，"></a>创建好之后显示以下信息，</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_5.png"></p><h3 id="目录结构如下，include-demo-one-pkg-文件用于存放编写的头文件-库文件"><a href="#目录结构如下，include-demo-one-pkg-文件用于存放编写的头文件-库文件" class="headerlink" title="目录结构如下，include&#x2F;demo_one_pkg 文件用于存放编写的头文件&#x2F;库文件"></a>目录结构如下，include&#x2F;demo_one_pkg 文件用于存放编写的头文件&#x2F;库文件</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_6.png"></p><h3 id="创建好包之后，进入-demo-one-pkg-src-目录下，创建一个-cpp-文件，这里叫-demo-one-cpp，内容如下，"><a href="#创建好包之后，进入-demo-one-pkg-src-目录下，创建一个-cpp-文件，这里叫-demo-one-cpp，内容如下，" class="headerlink" title="创建好包之后，进入 demo_one_pkg&#x2F;src&#x2F; 目录下，创建一个 .cpp 文件，这里叫 demo_one.cpp，内容如下，"></a>创建好包之后，进入 demo_one_pkg&#x2F;src&#x2F; 目录下，创建一个 .cpp 文件，这里叫 demo_one.cpp，内容如下，</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 初始化参数</span></span><br><span class="line">    rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line">    <span class="comment">// 创建节点</span></span><br><span class="line">    <span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;rclcpp::Node&gt;(<span class="string">&quot;demo_one_node&quot;</span>);</span><br><span class="line">    <span class="comment">// 打印日志</span></span><br><span class="line">    <span class="built_in">RCLCPP_INFO</span>(node-&gt;<span class="built_in">get_logger</span>(), <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="comment">// 运行节点</span></span><br><span class="line">    rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line">    <span class="comment">// 关闭节点</span></span><br><span class="line">    rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="返回上一级目录，即-demo-one-pkg-，编辑-CMakeLists-txt"><a href="#返回上一级目录，即-demo-one-pkg-，编辑-CMakeLists-txt" class="headerlink" title="返回上一级目录，即 demo_one_pkg&#x2F;，编辑 CMakeLists.txt"></a>返回上一级目录，即 demo_one_pkg&#x2F;，编辑 CMakeLists.txt</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.8)</span><br><span class="line">project(demo_one_pkg)</span><br><span class="line"></span><br><span class="line">if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES &quot;Clang&quot;)</span><br><span class="line">  add_compile_options(-Wall -Wextra -Wpedantic)</span><br><span class="line">endif()</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">找到依赖</span></span><br><span class="line">find_package(ament_cmake REQUIRED)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1.查找 rclcpp 的头文件和库文件</span></span><br><span class="line">find_package(rclcpp REQUIRED)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uncomment the following section <span class="keyword">in</span> order to fill <span class="keyword">in</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">further dependencies manually.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">find_package(&lt;dependency&gt; REQUIRED)</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2.添加可执行文件，(节点名，源文件地址)</span></span><br><span class="line">add_executable(demo_one_node src/demo_one.cpp)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">头文件包含</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">target_inlude_directories(demo_one_node PUBLIC <span class="variable">$&#123;rclcpp_INCLUDE_DIRS&#125;</span>)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">库文件链接</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">target_link_libraries(demo_one_node <span class="variable">$&#123;rclcpp_LIBRARIES&#125;</span>)</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上面两句用这一句代替,他是依赖于 find_package(ament_cmake REQUIRED) 的</span></span><br><span class="line">ament_target_dependencies(demo_one_node rclcpp)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 demo_one_node 拷贝到 install目录下</span></span><br><span class="line">install(TARGETS demo_one_node# 这里执行后目录就已经是 install/demo_one_pkg/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝到 install/pkg_name/lib/pkg_name/ 下</span></span><br><span class="line">DESTINATION lib/$&#123;PROJECT_NAME&#125;# 这里执行后最后目录就是 install/demo_one_pkg/lib/demo_one_pkg/</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if(BUILD_TESTING)</span><br><span class="line">  find_package(ament_lint_auto REQUIRED)</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">the following line skips the linter <span class="built_in">which</span> checks <span class="keyword">for</span> copyrights</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">comment the line when a copyright and license is added to all <span class="built_in">source</span> files</span></span><br><span class="line">  set(ament_cmake_copyright_FOUND TRUE)</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">the following line skips cpplint (only works <span class="keyword">in</span> a git repo)</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">comment the line when this package is <span class="keyword">in</span> a git repo and when</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">a copyright and license is added to all <span class="built_in">source</span> files</span></span><br><span class="line">  set(ament_cmake_cpplint_FOUND TRUE)</span><br><span class="line">  ament_lint_auto_find_test_dependencies()</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">ament_package()</span><br></pre></td></tr></table></figure><h3 id="在与-CMakeLists-txt-同级目录下还有一个-package-xml-文件，在该文件中也要对引用的头文件进行声明"><a href="#在与-CMakeLists-txt-同级目录下还有一个-package-xml-文件，在该文件中也要对引用的头文件进行声明" class="headerlink" title="在与 CMakeLists.txt 同级目录下还有一个 package.xml 文件，在该文件中也要对引用的头文件进行声明"></a>在与 CMakeLists.txt 同级目录下还有一个 package.xml 文件，在该文件中也要对引用的头文件进行声明</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-model href=<span class="string">&quot;http://download.ros.org/schema/package_format3.xsd&quot;</span> schematypens=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">format</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>demo_one_pkg<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>TODO: Package description<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maintainer</span> <span class="attr">email</span>=<span class="string">&quot;yanzu@todo.todo&quot;</span>&gt;</span>yanzu<span class="tag">&lt;/<span class="name">maintainer</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">license</span>&gt;</span>Apache-2.0<span class="tag">&lt;/<span class="name">license</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- 在这里添加头文件的声明 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">depend</span>&gt;</span>rclcpp<span class="tag">&lt;/<span class="name">depend</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">buildtool_depend</span>&gt;</span>ament_cmake<span class="tag">&lt;/<span class="name">buildtool_depend</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">test_depend</span>&gt;</span>ament_lint_auto<span class="tag">&lt;/<span class="name">test_depend</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">test_depend</span>&gt;</span>ament_lint_common<span class="tag">&lt;/<span class="name">test_depend</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">export</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build_type</span>&gt;</span>ament_cmake<span class="tag">&lt;/<span class="name">build_type</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">export</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="然后就可以对包进行编译了，编译时必须要在包的上一路径打开终端进行编译"><a href="#然后就可以对包进行编译了，编译时必须要在包的上一路径打开终端进行编译" class="headerlink" title="然后就可以对包进行编译了，编译时必须要在包的上一路径打开终端进行编译"></a>然后就可以对包进行编译了，编译时必须要在包的上一路径打开终端进行编译</h3><h3 id="在正式编译之前，可以在包目录下创建一个-build-文件先测试一下编译能否通过，创建这个build的目的是为了存放编译生成的文件"><a href="#在正式编译之前，可以在包目录下创建一个-build-文件先测试一下编译能否通过，创建这个build的目的是为了存放编译生成的文件" class="headerlink" title="在正式编译之前，可以在包目录下创建一个 build 文件先测试一下编译能否通过，创建这个build的目的是为了存放编译生成的文件"></a>在正式编译之前，可以在包目录下创建一个 build 文件先测试一下编译能否通过，创建这个build的目的是为了存放编译生成的文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build/</span><br><span class="line">cmake ../</span><br><span class="line">make</span><br></pre></td></tr></table></figure><h3 id="因为-CMakeLists-txt-在上一级目录中，要使其转换为-makefile-，所以是-cmake"><a href="#因为-CMakeLists-txt-在上一级目录中，要使其转换为-makefile-，所以是-cmake" class="headerlink" title="因为 CMakeLists.txt 在上一级目录中，要使其转换为 makefile ，所以是 cmake ..&#x2F;"></a>因为 CMakeLists.txt 在上一级目录中，要使其转换为 makefile ，所以是 cmake ..&#x2F;</h3><h3 id="这里在-demo-one-pkg-的上一路径下进行编译，也即-chapter-2-路径下进行编译"><a href="#这里在-demo-one-pkg-的上一路径下进行编译，也即-chapter-2-路径下进行编译" class="headerlink" title="这里在 demo_one_pkg 的上一路径下进行编译，也即 chapter_2&#x2F; 路径下进行编译"></a>这里在 demo_one_pkg 的上一路径下进行编译，也即 chapter_2&#x2F; 路径下进行编译</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line">colcon build</span><br></pre></td></tr></table></figure><h3 id="编译成功后，显示如下信息"><a href="#编译成功后，显示如下信息" class="headerlink" title="编译成功后，显示如下信息"></a>编译成功后，显示如下信息</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_7.png"></p><h3 id="此时，chapter-2-路径下分别有这些文件，build、install、log、demo-one-pkg"><a href="#此时，chapter-2-路径下分别有这些文件，build、install、log、demo-one-pkg" class="headerlink" title="此时，chapter_2&#x2F; 路径下分别有这些文件，build、install、log、demo_one_pkg"></a>此时，chapter_2&#x2F; 路径下分别有这些文件，build、install、log、demo_one_pkg</h3><h3 id="生成的可执行文件-demo-one-node-在-build-pkg-name-下，在该路径下，执行以下命令，可以查看当前节点依赖了哪些库，是否链接上"><a href="#生成的可执行文件-demo-one-node-在-build-pkg-name-下，在该路径下，执行以下命令，可以查看当前节点依赖了哪些库，是否链接上" class="headerlink" title="生成的可执行文件 demo_one_node 在 build&#x2F;pkg_name&#x2F; 下，在该路径下，执行以下命令，可以查看当前节点依赖了哪些库，是否链接上"></a>生成的可执行文件 demo_one_node 在 build&#x2F;pkg_name&#x2F; 下，在该路径下，执行以下命令，可以查看当前节点依赖了哪些库，是否链接上</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldd demo_one_node</span><br></pre></td></tr></table></figure><h3 id="正式运行节点之前要添加环境变量，可以使用以下命令查看当前包的环境变量是否配置了，未配置直接运行节点会显示找不到当前的包-以下命令都是在-chapter-2-路径下执行"><a href="#正式运行节点之前要添加环境变量，可以使用以下命令查看当前包的环境变量是否配置了，未配置直接运行节点会显示找不到当前的包-以下命令都是在-chapter-2-路径下执行" class="headerlink" title="正式运行节点之前要添加环境变量，可以使用以下命令查看当前包的环境变量是否配置了，未配置直接运行节点会显示找不到当前的包(以下命令都是在 chapter_2&#x2F; 路径下执行)"></a>正式运行节点之前要添加环境变量，可以使用以下命令查看当前包的环境变量是否配置了，未配置直接运行节点会显示找不到当前的包(以下命令都是在 chapter_2&#x2F; 路径下执行)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printenv | grep AMENT</span><br></pre></td></tr></table></figure><h3 id="使用以下命令进行环境变量配置"><a href="#使用以下命令进行环境变量配置" class="headerlink" title="使用以下命令进行环境变量配置"></a>使用以下命令进行环境变量配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source install/setup.bash</span><br></pre></td></tr></table></figure><h3 id="再使用上面查看环境变量的命令看看是否配置成功，最后运行节点（ros2-run-pkg-name-node-name）"><a href="#再使用上面查看环境变量的命令看看是否配置成功，最后运行节点（ros2-run-pkg-name-node-name）" class="headerlink" title="再使用上面查看环境变量的命令看看是否配置成功，最后运行节点（ros2 run pkg_name node_name）"></a>再使用上面查看环境变量的命令看看是否配置成功，最后运行节点（ros2 run pkg_name node_name）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 run demo_one_pkg demo_one_node</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu下安装与激活Typora</title>
      <link href="/2025/01/02/04/"/>
      <url>/2025/01/02/04/</url>
      
        <content type="html"><![CDATA[<h1 id="Ubuntu下安装与激活Typora"><a href="#Ubuntu下安装与激活Typora" class="headerlink" title="Ubuntu下安装与激活Typora"></a>Ubuntu下安装与激活Typora</h1><h2 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a>1.下载</h2><h3 id="直接在官网下载最新版-https-typora-io-releases-all"><a href="#直接在官网下载最新版-https-typora-io-releases-all" class="headerlink" title="直接在官网下载最新版 https://typora.io/releases/all"></a>直接在官网下载最新版 <a href="https://typora.io/releases/all">https://typora.io/releases/all</a></h3><h3 id="下载好-deb-之后，安装"><a href="#下载好-deb-之后，安装" class="headerlink" title="下载好 deb 之后，安装"></a>下载好 deb 之后，安装</h3><blockquote><h3 id="sudo-dpkg-i-xxx-deb"><a href="#sudo-dpkg-i-xxx-deb" class="headerlink" title="sudo dpkg -i xxx.deb"></a>sudo dpkg -i xxx.deb</h3></blockquote><h2 id="2-激活"><a href="#2-激活" class="headerlink" title="2.激活"></a>2.激活</h2><h3 id="在home下打开终端，依次执行以下命令"><a href="#在home下打开终端，依次执行以下命令" class="headerlink" title="在home下打开终端，依次执行以下命令"></a>在home下打开终端，依次执行以下命令</h3><blockquote><h3 id="git-clone-https-github-com-hazukieq-Yporaject-git"><a href="#git-clone-https-github-com-hazukieq-Yporaject-git" class="headerlink" title="git clone https://github.com/hazukieq/Yporaject.git"></a>git clone <a href="https://github.com/hazukieq/Yporaject.git">https://github.com/hazukieq/Yporaject.git</a></h3><h3 id="sudo-apt-install-cargo"><a href="#sudo-apt-install-cargo" class="headerlink" title="sudo apt install cargo"></a>sudo apt install cargo</h3><h3 id="cd-Yporaject"><a href="#cd-Yporaject" class="headerlink" title="cd Yporaject&#x2F;"></a>cd Yporaject&#x2F;</h3><h3 id="这一步最好打开梯子"><a href="#这一步最好打开梯子" class="headerlink" title="# 这一步最好打开梯子"></a># 这一步最好打开梯子</h3><h3 id="cargo-build"><a href="#cargo-build" class="headerlink" title="cargo build"></a>cargo build</h3><h3 id="最后显示-finished-就说明成功了"><a href="#最后显示-finished-就说明成功了" class="headerlink" title="最后显示 finished 就说明成功了"></a>最后显示 finished 就说明成功了</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_4.png"></p><h3 id="ls一下，看看有没有出现可执行文件-node-inject"><a href="#ls一下，看看有没有出现可执行文件-node-inject" class="headerlink" title="# ls一下，看看有没有出现可执行文件 node_inject"></a># ls一下，看看有没有出现可执行文件 node_inject</h3><h3 id="ls-target-debug"><a href="#ls-target-debug" class="headerlink" title="ls target&#x2F;debug"></a>ls target&#x2F;debug</h3><h3 id="cargo-run"><a href="#cargo-run" class="headerlink" title="cargo run"></a>cargo run</h3><h3 id="sudo-cp-target-debug-node-inject-usr-share-typora"><a href="#sudo-cp-target-debug-node-inject-usr-share-typora" class="headerlink" title="sudo cp target&#x2F;debug&#x2F;node_inject &#x2F;usr&#x2F;share&#x2F;typora"></a>sudo cp target&#x2F;debug&#x2F;node_inject &#x2F;usr&#x2F;share&#x2F;typora</h3><h3 id="上面的终端不要关闭"><a href="#上面的终端不要关闭" class="headerlink" title="上面的终端不要关闭"></a>上面的终端不要关闭</h3></blockquote><h3 id="在-home-下打开新的终端，依次执行一下命令，"><a href="#在-home-下打开新的终端，依次执行一下命令，" class="headerlink" title="在 home 下打开新的终端，依次执行一下命令，"></a>在 home 下打开新的终端，依次执行一下命令，</h3><blockquote><h3 id="cd-usr-share-typora"><a href="#cd-usr-share-typora" class="headerlink" title="cd &#x2F;usr&#x2F;share&#x2F;typora&#x2F;"></a>cd &#x2F;usr&#x2F;share&#x2F;typora&#x2F;</h3><h3 id="权限拉闷"><a href="#权限拉闷" class="headerlink" title="# 权限拉闷"></a># 权限拉闷</h3><h3 id="sudo-chmod-777-node-inject"><a href="#sudo-chmod-777-node-inject" class="headerlink" title="sudo chmod 777 node_inject"></a>sudo chmod 777 node_inject</h3><h3 id="sudo-node-inject"><a href="#sudo-node-inject" class="headerlink" title="sudo .&#x2F;node_inject"></a>sudo .&#x2F;node_inject</h3><h3 id="终端输出了以下信息就说明可以了"><a href="#终端输出了以下信息就说明可以了" class="headerlink" title="# 终端输出了以下信息就说明可以了"></a># 终端输出了以下信息就说明可以了</h3><h3 id="extracting-node-modules-asar"><a href="#extracting-node-modules-asar" class="headerlink" title="extracting node_modules.asar"></a>extracting node_modules.asar</h3><h3 id="adding-hook-js"><a href="#adding-hook-js" class="headerlink" title="adding hook.js"></a>adding hook.js</h3><h3 id="applying-patch"><a href="#applying-patch" class="headerlink" title="applying patch"></a>applying patch</h3><h3 id="packing-node-modules-asar"><a href="#packing-node-modules-asar" class="headerlink" title="packing node_modules.asar"></a>packing node_modules.asar</h3><h3 id="done"><a href="#done" class="headerlink" title="done!"></a>done!</h3><h3 id="可以关掉这个终端了"><a href="#可以关掉这个终端了" class="headerlink" title="可以关掉这个终端了"></a>可以关掉这个终端了</h3></blockquote><h3 id="返回之前的终端，依次执行以下命令，"><a href="#返回之前的终端，依次执行以下命令，" class="headerlink" title="返回之前的终端，依次执行以下命令，"></a>返回之前的终端，依次执行以下命令，</h3><blockquote><h3 id="cd-license-gen"><a href="#cd-license-gen" class="headerlink" title="cd license-gen&#x2F;"></a>cd license-gen&#x2F;</h3><h3 id="这一步同样打开梯子进行"><a href="#这一步同样打开梯子进行" class="headerlink" title="# 这一步同样打开梯子进行"></a># 这一步同样打开梯子进行</h3><h3 id="cargo-build-1"><a href="#cargo-build-1" class="headerlink" title="cargo build"></a>cargo build</h3><h3 id="cargo-run-1"><a href="#cargo-run-1" class="headerlink" title="cargo run"></a>cargo run</h3><h3 id="然后就得到了激活码了"><a href="#然后就得到了激活码了" class="headerlink" title="然后就得到了激活码了"></a>然后就得到了激活码了</h3></blockquote><h3 id="这个激活教程真的太6了，当然不是我自己原创，在“垃圾堆”里面找到的，原作者也不知道是不是他，贴一手地址，"><a href="#这个激活教程真的太6了，当然不是我自己原创，在“垃圾堆”里面找到的，原作者也不知道是不是他，贴一手地址，" class="headerlink" title="这个激活教程真的太6了，当然不是我自己原创，在“垃圾堆”里面找到的，原作者也不知道是不是他，贴一手地址，"></a>这个激活教程真的太6了，当然不是我自己原创，在“垃圾堆”里面找到的，原作者也不知道是不是他，贴一手地址，</h3><h3 id="https-blog-csdn-net-weixin-65657501-article-details-142788747"><a href="#https-blog-csdn-net-weixin-65657501-article-details-142788747" class="headerlink" title="https://blog.csdn.net/weixin_65657501/article/details/142788747"></a><a href="https://blog.csdn.net/weixin_65657501/article/details/142788747">https://blog.csdn.net/weixin_65657501/article/details/142788747</a></h3>]]></content>
      
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
            <tag> 安装教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第三弹</title>
      <link href="/2025/01/01/03/"/>
      <url>/2025/01/01/03/</url>
      
        <content type="html"><![CDATA[<h1 id="使用-CMakeLists-管理-cpp"><a href="#使用-CMakeLists-管理-cpp" class="headerlink" title="使用 CMakeLists 管理 cpp"></a>使用 CMakeLists 管理 cpp</h1><h3 id="在当前目录下创建一个-cpp-文件，如-hello-cpp，内容就是输出-hello-world"><a href="#在当前目录下创建一个-cpp-文件，如-hello-cpp，内容就是输出-hello-world" class="headerlink" title="在当前目录下创建一个 cpp 文件，如 hello.cpp，内容就是输出 hello world"></a>在当前目录下创建一个 cpp 文件，如 hello.cpp，内容就是输出 hello world</h3><h3 id="再创建一个-CMakeLists-txt-的文件，内容如下"><a href="#再创建一个-CMakeLists-txt-的文件，内容如下" class="headerlink" title="再创建一个 CMakeLists.txt 的文件，内容如下:"></a>再创建一个 CMakeLists.txt 的文件，内容如下:</h3><blockquote><h3 id="指定-cmake-的最小版本"><a href="#指定-cmake-的最小版本" class="headerlink" title="# 指定 cmake 的最小版本"></a># 指定 cmake 的最小版本</h3><h3 id="cmake-minimum-required-VERSION-3-8"><a href="#cmake-minimum-required-VERSION-3-8" class="headerlink" title="cmake_minimum_required(VERSION 3.8)"></a>cmake_minimum_required(VERSION 3.8)</h3><h3 id="项目名称"><a href="#项目名称" class="headerlink" title="# 项目名称"></a># 项目名称</h3><h3 id="project-hello"><a href="#project-hello" class="headerlink" title="project(hello)"></a>project(hello)</h3><h3 id="添加可执行文件，-可执行文件名，源文件名"><a href="#添加可执行文件，-可执行文件名，源文件名" class="headerlink" title="# 添加可执行文件，(可执行文件名，源文件名)"></a># 添加可执行文件，(可执行文件名，源文件名)</h3><h3 id="add-executable-learn-cmake-hello-cpp"><a href="#add-executable-learn-cmake-hello-cpp" class="headerlink" title="add_executable(learn_cmake hello.cpp)"></a>add_executable(learn_cmake hello.cpp)</h3></blockquote><h3 id="然后执行命令-当前路径下打开命令框-，将-cmake-转换为-makefile"><a href="#然后执行命令-当前路径下打开命令框-，将-cmake-转换为-makefile" class="headerlink" title="然后执行命令(当前路径下打开命令框)，将 cmake 转换为 makefile"></a>然后执行命令(当前路径下打开命令框)，将 cmake 转换为 makefile</h3><blockquote><h3 id="cmake-后面跟的是目录"><a href="#cmake-后面跟的是目录" class="headerlink" title="# cmake 后面跟的是目录"></a># cmake 后面跟的是目录</h3><h3 id="cmake"><a href="#cmake" class="headerlink" title="$ cmake ."></a>$ cmake .</h3></blockquote><h3 id="再执行命令，编译生成可执行文件"><a href="#再执行命令，编译生成可执行文件" class="headerlink" title="再执行命令，编译生成可执行文件"></a>再执行命令，编译生成可执行文件</h3><blockquote><h3 id="make"><a href="#make" class="headerlink" title="$ make"></a>$ make</h3></blockquote><h3 id="此时就生成了可执行文件-learn-cmake-了，可以直接运行"><a href="#此时就生成了可执行文件-learn-cmake-了，可以直接运行" class="headerlink" title="此时就生成了可执行文件 learn_cmake 了，可以直接运行"></a>此时就生成了可执行文件 learn_cmake 了，可以直接运行</h3><blockquote><h3 id="learn-cmake"><a href="#learn-cmake" class="headerlink" title="$ .&#x2F;learn_cmake"></a>$ .&#x2F;learn_cmake</h3></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二弹</title>
      <link href="/2025/01/01/02/"/>
      <url>/2025/01/01/02/</url>
      
        <content type="html"><![CDATA[<h1 id="常用的-Linux-操作命令"><a href="#常用的-Linux-操作命令" class="headerlink" title="常用的 Linux 操作命令"></a>常用的 Linux 操作命令</h1><h3 id="当前终端所在目录"><a href="#当前终端所在目录" class="headerlink" title="当前终端所在目录"></a>当前终端所在目录</h3><blockquote><h3 id="pwd"><a href="#pwd" class="headerlink" title="$ pwd"></a>$ pwd</h3></blockquote><h3 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h3><blockquote><h3 id="cat-name-txt"><a href="#cat-name-txt" class="headerlink" title="$ cat name.txt"></a>$ cat name.txt</h3></blockquote><h3 id="卸载某个包"><a href="#卸载某个包" class="headerlink" title="卸载某个包"></a>卸载某个包</h3><blockquote><h3 id="sudo-apt-remove-pkg-name"><a href="#sudo-apt-remove-pkg-name" class="headerlink" title="$ sudo apt remove pkg_name"></a>$ sudo apt remove pkg_name</h3></blockquote><h3 id="安装-deb"><a href="#安装-deb" class="headerlink" title="安装 .deb"></a>安装 .deb</h3><blockquote><h3 id="sudo-dpkg-i-file-name-deb"><a href="#sudo-dpkg-i-file-name-deb" class="headerlink" title="$ sudo dpkg -i file_name.deb"></a>$ sudo dpkg -i file_name.deb</h3></blockquote><h3 id="解压-tar-gz-tgz"><a href="#解压-tar-gz-tgz" class="headerlink" title="解压 .tar.gz&#x2F;.tgz"></a>解压 .tar.gz&#x2F;.tgz</h3><blockquote><h3 id="tar-xzvf-file-tar-gz-C-path"><a href="#tar-xzvf-file-tar-gz-C-path" class="headerlink" title="$ tar -xzvf file.tar.gz -C &#x2F;path"></a>$ tar -xzvf file.tar.gz -C &#x2F;path</h3></blockquote><h3 id="解压-zip"><a href="#解压-zip" class="headerlink" title="解压 .zip"></a>解压 .zip</h3><blockquote><h3 id="unzip-file-zip-d-path"><a href="#unzip-file-zip-d-path" class="headerlink" title="$ unzip file.zip -d &#x2F;path"></a>$ unzip file.zip -d &#x2F;path</h3></blockquote><h3 id="解压-rar"><a href="#解压-rar" class="headerlink" title="解压 .rar"></a>解压 .rar</h3><blockquote><h3 id="unrar-x-file-rar"><a href="#unrar-x-file-rar" class="headerlink" title="$ unrar x file.rar"></a>$ unrar x file.rar</h3></blockquote><h3 id="查找某个文件"><a href="#查找某个文件" class="headerlink" title="查找某个文件"></a>查找某个文件</h3><blockquote><h3 id="whereis-file-name"><a href="#whereis-file-name" class="headerlink" title="$ whereis file_name"></a>$ whereis file_name</h3></blockquote><h3 id="使用-nano-编辑文本"><a href="#使用-nano-编辑文本" class="headerlink" title="使用 nano 编辑文本"></a>使用 nano 编辑文本</h3><blockquote><h3 id="nano-file-name"><a href="#nano-file-name" class="headerlink" title="$ nano file_name"></a>$ nano file_name</h3></blockquote><h3 id="查看执行过的命令"><a href="#查看执行过的命令" class="headerlink" title="查看执行过的命令"></a>查看执行过的命令</h3><blockquote><h3 id="history"><a href="#history" class="headerlink" title="$ history"></a>$ history</h3></blockquote><h3 id="终端中的复制粘贴快捷键"><a href="#终端中的复制粘贴快捷键" class="headerlink" title="终端中的复制粘贴快捷键"></a>终端中的复制粘贴快捷键</h3><blockquote><h3 id="ctrl-shift-C-ctrl-shift-V"><a href="#ctrl-shift-C-ctrl-shift-V" class="headerlink" title="ctrl + shift + C &#x2F; ctrl + shift + V"></a>ctrl + shift + C &#x2F; ctrl + shift + V</h3></blockquote><h3 id="终端中执行-py"><a href="#终端中执行-py" class="headerlink" title="终端中执行 .py"></a>终端中执行 .py</h3><blockquote><h3 id="python3-file-name-py"><a href="#python3-file-name-py" class="headerlink" title="$ python3 file_name.py"></a>$ python3 file_name.py</h3></blockquote><h3 id="给文件添加权限，文件或者目录的权限分为三类，权限也分为三类"><a href="#给文件添加权限，文件或者目录的权限分为三类，权限也分为三类" class="headerlink" title="给文件添加权限，文件或者目录的权限分为三类，权限也分为三类"></a>给文件添加权限，文件或者目录的权限分为三类，权限也分为三类</h3><blockquote><h4 id="1-用户-user-u-：文件拥有者"><a href="#1-用户-user-u-：文件拥有者" class="headerlink" title="1.用户(user,u)：文件拥有者"></a>1.用户(user,u)：文件拥有者</h4><h4 id="2-组-group-g-：与user在同一组的用户"><a href="#2-组-group-g-：与user在同一组的用户" class="headerlink" title="2.组(group,g)：与user在同一组的用户"></a>2.组(group,g)：与user在同一组的用户</h4><h4 id="3-其他人-others-o-：所有其他用户"><a href="#3-其他人-others-o-：所有其他用户" class="headerlink" title="3.其他人(others,o)：所有其他用户"></a>3.其他人(others,o)：所有其他用户</h4><h4 id="读，r，值为-4-；写，w，值为-2-；执行，x，值为-1"><a href="#读，r，值为-4-；写，w，值为-2-；执行，x，值为-1" class="headerlink" title="读，r，值为 4 ；写，w，值为 2 ；执行，x，值为 1"></a>读，r，值为 4 ；写，w，值为 2 ；执行，x，值为 1</h4></blockquote><h3 id="赋予所有用户执行权，添加权限就是-，移除权限就是"><a href="#赋予所有用户执行权，添加权限就是-，移除权限就是" class="headerlink" title="赋予所有用户执行权，添加权限就是 + ，移除权限就是 -"></a>赋予所有用户执行权，添加权限就是 + ，移除权限就是 -</h3><blockquote><h3 id="chmod-a-x-file"><a href="#chmod-a-x-file" class="headerlink" title="$ chmod a+x file"></a>$ chmod a+x file</h3></blockquote><h3 id="查看文件-目录权限"><a href="#查看文件-目录权限" class="headerlink" title="查看文件&#x2F;目录权限"></a>查看文件&#x2F;目录权限</h3><blockquote><h3 id="ls-l-file"><a href="#ls-l-file" class="headerlink" title="$ ls -l file"></a>$ ls -l file</h3></blockquote><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_3.png" alt="pic"></p><h3 id="要在命令框中直接执行-py-文件，不使用-python3-file-py，要指定编译器，在-py-文件顶部添加"><a href="#要在命令框中直接执行-py-文件，不使用-python3-file-py，要指定编译器，在-py-文件顶部添加" class="headerlink" title="要在命令框中直接执行 .py 文件，不使用 python3 file.py，要指定编译器，在 .py 文件顶部添加"></a>要在命令框中直接执行 .py 文件，不使用 python3 file.py，要指定编译器，在 .py 文件顶部添加</h3><blockquote><h3 id="usr-bin-python3"><a href="#usr-bin-python3" class="headerlink" title="#!usr&#x2F;bin&#x2F;python3"></a>#!usr&#x2F;bin&#x2F;python3</h3><h3 id="然后就可以使用"><a href="#然后就可以使用" class="headerlink" title="然后就可以使用"></a>然后就可以使用</h3><h3 id="file-py"><a href="#file-py" class="headerlink" title="$ .&#x2F;file.py"></a>$ .&#x2F;file.py</h3></blockquote><h3 id="echo-指令的使用，echo-本身的功能就是打印其后的字符"><a href="#echo-指令的使用，echo-本身的功能就是打印其后的字符" class="headerlink" title="echo 指令的使用，echo 本身的功能就是打印其后的字符"></a>echo 指令的使用，echo 本身的功能就是打印其后的字符</h3><blockquote><h3 id="可以找到跟在其后的字符的环境变量，echo-就能打印该环境变量"><a href="#可以找到跟在其后的字符的环境变量，echo-就能打印该环境变量" class="headerlink" title="$ 可以找到跟在其后的字符的环境变量，echo 就能打印该环境变量"></a>$ 可以找到跟在其后的字符的环境变量，echo 就能打印该环境变量</h3><h3 id="echo-ROS-VERSION"><a href="#echo-ROS-VERSION" class="headerlink" title="$ echo $ROS_VERSION"></a>$ echo $ROS_VERSION</h3><h3 id="查看-ros-的发行版本"><a href="#查看-ros-的发行版本" class="headerlink" title="# 查看 ros 的发行版本"></a># 查看 ros 的发行版本</h3><h3 id="echo-ROS-DISTRO"><a href="#echo-ROS-DISTRO" class="headerlink" title="$ echo $ROS_DISTRO"></a>$ echo $ROS_DISTRO</h3></blockquote><h3 id="查看所有环境变量列表"><a href="#查看所有环境变量列表" class="headerlink" title="查看所有环境变量列表"></a>查看所有环境变量列表</h3><blockquote><h3 id="printenv"><a href="#printenv" class="headerlink" title="$ printenv"></a>$ printenv</h3></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一弹</title>
      <link href="/2024/12/04/01/"/>
      <url>/2024/12/04/01/</url>
      
        <content type="html"><![CDATA[<h1 id="ROS2-的安装"><a href="#ROS2-的安装" class="headerlink" title="ROS2 的安装"></a>ROS2 的安装</h1><h3 id="鱼香ROS安装命令"><a href="#鱼香ROS安装命令" class="headerlink" title="鱼香ROS安装命令"></a>鱼香ROS安装命令</h3><blockquote><h3 id="wget-http-fishros-com-install-O-fishros-bash-fishros"><a href="#wget-http-fishros-com-install-O-fishros-bash-fishros" class="headerlink" title="$ wget http://fishros.com/install -O fishros &amp;&amp; bash fishros"></a>$ wget <a href="http://fishros.com/install">http://fishros.com/install</a> -O fishros &amp;&amp; bash fishros</h3></blockquote><h3 id="安装成功后可使用以下命令查看"><a href="#安装成功后可使用以下命令查看" class="headerlink" title="安装成功后可使用以下命令查看"></a>安装成功后可使用以下命令查看</h3><blockquote><h3 id="ros2"><a href="#ros2" class="headerlink" title="$ ros2"></a>$ ros2</h3></blockquote><h3 id="测试安装是否成功，运行小海龟"><a href="#测试安装是否成功，运行小海龟" class="headerlink" title="测试安装是否成功，运行小海龟"></a>测试安装是否成功，运行小海龟</h3><h4 id="先运行一个小海龟节点"><a href="#先运行一个小海龟节点" class="headerlink" title="先运行一个小海龟节点"></a>先运行一个小海龟节点</h4><blockquote><h3 id="ros2-run-turtlesim-turtlesim-node"><a href="#ros2-run-turtlesim-turtlesim-node" class="headerlink" title="$ ros2 run turtlesim turtlesim_node"></a>$ ros2 run turtlesim turtlesim_node</h3></blockquote><h4 id="新建一个命令框运行另外一个节点，与前一个节点通信，从而通过键盘来控制小海龟移动"><a href="#新建一个命令框运行另外一个节点，与前一个节点通信，从而通过键盘来控制小海龟移动" class="headerlink" title="新建一个命令框运行另外一个节点，与前一个节点通信，从而通过键盘来控制小海龟移动"></a>新建一个命令框运行另外一个节点，与前一个节点通信，从而通过键盘来控制小海龟移动</h4><blockquote><h3 id="ros2-run-turtlesim-turtle-teleop-key"><a href="#ros2-run-turtlesim-turtle-teleop-key" class="headerlink" title="$ ros2 run turtlesim turtle_teleop_key"></a>$ ros2 run turtlesim turtle_teleop_key</h3></blockquote><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_1.png" alt="pic"></p><h4 id="此时可以再新建一个命令框，执行"><a href="#此时可以再新建一个命令框，执行" class="headerlink" title="此时可以再新建一个命令框，执行"></a>此时可以再新建一个命令框，执行</h4><blockquote><h3 id="rqt"><a href="#rqt" class="headerlink" title="$ rqt"></a>$ rqt</h3></blockquote><h3 id="点击-plugins-introspection-node-graph，就可以看到当前两个节点之间的通信情况了"><a href="#点击-plugins-introspection-node-graph，就可以看到当前两个节点之间的通信情况了" class="headerlink" title="点击 plugins -&gt; introspection -&gt; node graph，就可以看到当前两个节点之间的通信情况了"></a>点击 plugins -&gt; introspection -&gt; node graph，就可以看到当前两个节点之间的通信情况了</h3><h3 id="teleop-turtle-通过-turtle1-cmd-vel-对-turtlesim-进行控制"><a href="#teleop-turtle-通过-turtle1-cmd-vel-对-turtlesim-进行控制" class="headerlink" title="teleop_turtle 通过 &#x2F;turtle1&#x2F;cmd_vel 对 turtlesim 进行控制"></a>teleop_turtle 通过 &#x2F;turtle1&#x2F;cmd_vel 对 turtlesim 进行控制</h3><p><img src="http://picbed.yanzu.tech/img/learn_ros2/pic_2.png" alt="pic"></p><h3 id="ros2-run-turtlesim-turtlesim-node-这条命令是什么意思，又是如何执行的？"><a href="#ros2-run-turtlesim-turtlesim-node-这条命令是什么意思，又是如何执行的？" class="headerlink" title="ros2 run turtlesim turtlesim_node 这条命令是什么意思，又是如何执行的？"></a>ros2 run turtlesim turtlesim_node 这条命令是什么意思，又是如何执行的？</h3><blockquote><h3 id="首先，-ros2-run-会找到一个环境变量-AMENT-PREFIX-PATH，可能有多个值，多值就循环遍历"><a href="#首先，-ros2-run-会找到一个环境变量-AMENT-PREFIX-PATH，可能有多个值，多值就循环遍历" class="headerlink" title="首先， ros2 run 会找到一个环境变量 AMENT_PREFIX_PATH，可能有多个值，多值就循环遍历"></a>首先， ros2 run 会找到一个环境变量 AMENT_PREFIX_PATH，可能有多个值，多值就循环遍历</h3><h3 id="接着，在这个环境变量对应的路径下去找-lib-文件，找到后再在其目录下找-turtlesim-包"><a href="#接着，在这个环境变量对应的路径下去找-lib-文件，找到后再在其目录下找-turtlesim-包" class="headerlink" title="接着，在这个环境变量对应的路径下去找 lib 文件，找到后再在其目录下找 turtlesim 包"></a>接着，在这个环境变量对应的路径下去找 lib 文件，找到后再在其目录下找 turtlesim 包</h3><h3 id="找到对应的包之后，在其目录下找到可执行文件-turtlesim-node，然后执行"><a href="#找到对应的包之后，在其目录下找到可执行文件-turtlesim-node，然后执行" class="headerlink" title="找到对应的包之后，在其目录下找到可执行文件 turtlesim_node，然后执行"></a>找到对应的包之后，在其目录下找到可执行文件 turtlesim_node，然后执行</h3><h3 id="那么可以直接使用以下命令代替执行对应的可执行文件"><a href="#那么可以直接使用以下命令代替执行对应的可执行文件" class="headerlink" title="那么可以直接使用以下命令代替执行对应的可执行文件"></a>那么可以直接使用以下命令代替执行对应的可执行文件</h3><h3 id="但只能是-AMENT-PREFIX-PATH-opt-ros-humble-的情况下才能这么执行"><a href="#但只能是-AMENT-PREFIX-PATH-opt-ros-humble-的情况下才能这么执行" class="headerlink" title="(但只能是 AMENT_PREFIX_PATH&#x3D;&#x2F;opt&#x2F;ros&#x2F;humble 的情况下才能这么执行)"></a>(但只能是 AMENT_PREFIX_PATH&#x3D;&#x2F;opt&#x2F;ros&#x2F;humble 的情况下才能这么执行)</h3><h3 id="AMENT-PREFIX-PATH-lib-turtlesim-turtlesim-node"><a href="#AMENT-PREFIX-PATH-lib-turtlesim-turtlesim-node" class="headerlink" title="$ $AMENT_PREFIX_PATH&#x2F;lib&#x2F;turtlesim&#x2F;turtlesim_node"></a>$ $AMENT_PREFIX_PATH&#x2F;lib&#x2F;turtlesim&#x2F;turtlesim_node</h3></blockquote><h3 id="修改环境变量，-export-环境变量名-path"><a href="#修改环境变量，-export-环境变量名-path" class="headerlink" title="修改环境变量， export 环境变量名&#x3D;path"></a>修改环境变量， export 环境变量名&#x3D;path</h3><blockquote><h3 id="export-AMENT-PREFIX-PATH-opt-ros"><a href="#export-AMENT-PREFIX-PATH-opt-ros" class="headerlink" title="export AMENT_PREFIX_PATH&#x3D;&#x2F;opt&#x2F;ros"></a>export AMENT_PREFIX_PATH&#x3D;&#x2F;opt&#x2F;ros</h3></blockquote><h3 id="在-linux-中，以-点-如-a-txt-开头的文件或文件夹是隐藏文件"><a href="#在-linux-中，以-点-如-a-txt-开头的文件或文件夹是隐藏文件" class="headerlink" title="在 linux 中，以 点(如 .a.txt) 开头的文件或文件夹是隐藏文件"></a>在 linux 中，以 点(如 .a.txt) 开头的文件或文件夹是隐藏文件</h3><blockquote><h3 id="查看当前目录下的所有文件，包括隐藏文件"><a href="#查看当前目录下的所有文件，包括隐藏文件" class="headerlink" title="查看当前目录下的所有文件，包括隐藏文件"></a>查看当前目录下的所有文件，包括隐藏文件</h3><h3 id="ls-a"><a href="#ls-a" class="headerlink" title="$ ls -a"></a>$ ls -a</h3></blockquote><h3 id="只要一打开终端，就会默认启动一个脚本-bashrc，他会设置一系列的环境变量"><a href="#只要一打开终端，就会默认启动一个脚本-bashrc，他会设置一系列的环境变量" class="headerlink" title="只要一打开终端，就会默认启动一个脚本 .bashrc，他会设置一系列的环境变量"></a>只要一打开终端，就会默认启动一个脚本 .bashrc，他会设置一系列的环境变量</h3>]]></content>
      
      
      
        <tags>
            
            <tag> ROS2 </tag>
            
            <tag> Learning </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
